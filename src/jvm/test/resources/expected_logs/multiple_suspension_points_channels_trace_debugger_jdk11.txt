= Invalid execution results =
| ------------------------------------------------------------------------------- |
|                Thread 1                |                Thread 2                |
| ------------------------------------------------------------------------------- |
| operation1(): IllegalStateException #1 | operation2(): IllegalStateException #2 |
| ------------------------------------------------------------------------------- |

---
The number next to an exception name helps you find its stack trace provided after the interleaving section
---

The following interleaving leads to the error:
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                      Thread 1                                                                                      |                                                                                      Thread 2                                                                                      |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                                                                    | operation2(): IllegalStateException #2                                                                                                                                             |
|                                                                                                                                                                                    |   channel1.receive() (suspendable with <continuation>#1): 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:166)                 |
|                                                                                                                                                                                    |     receiveSegment.get(): ChannelSegment#1 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                        |
|                                                                                                                                                                                    |     this_$iv.isClosedForReceive(): false at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                          |
|                                                                                                                                                                                    |     receivers.getAndIncrement(): 0 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                |
|                                                                                                                                                                                    |     BufferedChannel.updateCellReceive(ChannelSegment#1, 0, 0, null): <SUSPEND_NO_WAITER> at BufferedChannel.receive(BufferedChannel.kt:0)                                          |
|                                                                                                                                                                                    |     $this.receiveOnNoWaiterSuspend(ChannelSegment#1, 0, 0) (suspendable with <continuation>#1): 1 at BufferedChannel.receive(BufferedChannel.kt:0)                                 |
|                                                                                                                                                                                    |       BufferedChannel.updateCellReceive(ChannelSegment#1, 0, 0) (suspendable with <continuation>#3): 1 at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:3575)        |
|                                                                                                                                                                                    |         segment.getState$kotlinx_coroutines_core(0): null at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                             |
|                                                                                                                                                                                    |         sendersAndCloseStatus.get(): 0 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1007)                                                                               |
|                                                                                                                                                                                    |         switch                                                                                                                                                                     |
| operation1(): IllegalStateException #1                                                                                                                                             |                                                                                                                                                                                    |
|   channel1.send(1) (suspendable with <continuation>#4) at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:156)                      |                                                                                                                                                                                    |
|   counter ➜ 0 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                               |                                                                                                                                                                                    |
|   switch                                                                                                                                                                           |                                                                                                                                                                                    |
|                                                                                                                                                                                    |         segment.casState$kotlinx_coroutines_core(0, null) (suspendable with <continuation>#3): false at BufferedChannel.updateCellReceive(BufferedChannel.kt:1016)                 |
|                                                                                                                                                                                    |         updateCellReceiveSlow(ChannelSegment#1, 0, 0) (suspendable with <continuation>#3): 1 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1031)                         |
|                                                                                                                                                                                    |       segment.cleanPrev() at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:3636)                                                                                     |
|                                                                                                                                                                                    |       cont.resume(1, null) at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:709)                                                                                     |
|                                                                                                                                                                                    |       cancellable$iv.getResult(): 1 at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:3648)                                                                           |
|                                                                                                                                                                                    |   counter ➜ 0 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                               |
|                                                                                                                                                                                    |   counter = 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                               |
|                                                                                                                                                                                    |   channel2.send(1) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:168) |
|                                                                                                                                                                                    |     sendSegment.get(): ChannelSegment#2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                              |
|                                                                                                                                                                                    |     sendersAndCloseStatus.getAndIncrement(): 0 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                       |
|                                                                                                                                                                                    |     BufferedChannel.updateCellSend(ChannelSegment#2, 0, 1, 0, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                        |
|                                                                                                                                                                                    |     $this.sendOnNoWaiterSuspend(ChannelSegment#2, 0, 1, 0) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                  |
|                                                                                                                                                                                    |       BufferedChannel.updateCellSend(ChannelSegment#2, 0, 1, 0, <continuation>#5, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                      |
|                                                                                                                                                                                    |       BufferedChannel.prepareSenderForSuspension(<continuation>#5, ChannelSegment#2, 0) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                          |
|                                                                                                                                                                                    |       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                            |
|                                                                                                                                                                                    |         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                           |
|                                                                                                                                                                                    |         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                            |
|                                                                                                                                                                                    |         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                       |
|                                                                                                                                                                                    |         installParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                    |
|                                                                                                                                                                                    |         switch (reason: coroutine is suspended)                                                                                                                                    |
|   counter = 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                               |                                                                                                                                                                                    |
|   channel2.receive() (suspendable with <continuation>#4): 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:158)                 |                                                                                                                                                                                    |
|   channel1.send(2) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:156) |                                                                                                                                                                                    |
|     sendSegment.get(): ChannelSegment#1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                              |                                                                                                                                                                                    |
|     sendersAndCloseStatus.getAndIncrement(): 1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                       |                                                                                                                                                                                    |
|     BufferedChannel.updateCellSend(ChannelSegment#1, 1, 2, 1, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                        |                                                                                                                                                                                    |
|     $this.sendOnNoWaiterSuspend(ChannelSegment#1, 1, 2, 1) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                  |                                                                                                                                                                                    |
|       BufferedChannel.updateCellSend(ChannelSegment#1, 1, 2, 1, <continuation>#7, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                      |                                                                                                                                                                                    |
|       BufferedChannel.prepareSenderForSuspension(<continuation>#7, ChannelSegment#1, 1) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                          |                                                                                                                                                                                    |
|       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                            |                                                                                                                                                                                    |
|         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                           |                                                                                                                                                                                    |
|         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                            |                                                                                                                                                                                    |
|         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                       |                                                                                                                                                                                    |
|         installParentHandle(): ChildContinuation#2 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                    |                                                                                                                                                                                    |
|         switch (reason: coroutine is suspended)                                                                                                                                    |                                                                                                                                                                                    |
|                                                                                                                                                                                    |   channel1.receive() (suspendable with <continuation>#1): 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:166)                 |
|                                                                                                                                                                                    |   counter ➜ 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                               |
|                                                                                                                                                                                    |   counter = 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                               |
|                                                                                                                                                                                    |   channel2.send(2) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:168) |
|                                                                                                                                                                                    |     sendSegment.get(): ChannelSegment#2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                              |
|                                                                                                                                                                                    |     sendersAndCloseStatus.getAndIncrement(): 1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                       |
|                                                                                                                                                                                    |     BufferedChannel.updateCellSend(ChannelSegment#2, 1, 2, 1, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                        |
|                                                                                                                                                                                    |     $this.sendOnNoWaiterSuspend(ChannelSegment#2, 1, 2, 1) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                  |
|                                                                                                                                                                                    |       BufferedChannel.updateCellSend(ChannelSegment#2, 1, 2, 1, <continuation>#8, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                      |
|                                                                                                                                                                                    |       BufferedChannel.prepareSenderForSuspension(<continuation>#8, ChannelSegment#2, 1) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                          |
|                                                                                                                                                                                    |       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                            |
|                                                                                                                                                                                    |         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                           |
|                                                                                                                                                                                    |         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                            |
|                                                                                                                                                                                    |         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                       |
|                                                                                                                                                                                    |         installParentHandle(): ChildContinuation#3 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                    |
|                                                                                                                                                                                    |         switch (reason: coroutine is suspended)                                                                                                                                    |
|   counter ➜ 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                               |                                                                                                                                                                                    |
|   counter = 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                               |                                                                                                                                                                                    |
|   channel2.receive() (suspendable with <continuation>#4): 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:158)                 |                                                                                                                                                                                    |
|   channel1.send(3) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:156) |                                                                                                                                                                                    |
|     sendSegment.get(): ChannelSegment#1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                              |                                                                                                                                                                                    |
|     sendersAndCloseStatus.getAndIncrement(): 2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                       |                                                                                                                                                                                    |
|     BufferedChannel.updateCellSend(ChannelSegment#1, 2, 3, 2, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                        |                                                                                                                                                                                    |
|     $this.sendOnNoWaiterSuspend(ChannelSegment#1, 2, 3, 2) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                  |                                                                                                                                                                                    |
|       BufferedChannel.updateCellSend(ChannelSegment#1, 2, 3, 2, <continuation>#9, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                      |                                                                                                                                                                                    |
|       BufferedChannel.prepareSenderForSuspension(<continuation>#9, ChannelSegment#1, 2) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                          |                                                                                                                                                                                    |
|       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                            |                                                                                                                                                                                    |
|         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                           |                                                                                                                                                                                    |
|         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                            |                                                                                                                                                                                    |
|         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                       |                                                                                                                                                                                    |
|         installParentHandle(): ChildContinuation#4 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                    |                                                                                                                                                                                    |
|         switch (reason: coroutine is suspended)                                                                                                                                    |                                                                                                                                                                                    |
|                                                                                                                                                                                    |   channel1.receive() (suspendable with <continuation>#1): 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:166)                 |
|                                                                                                                                                                                    |   counter ➜ 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                               |
|                                                                                                                                                                                    |   counter = 4 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                               |
|                                                                                                                                                                                    |   channel2.send(3) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:168) |
|                                                                                                                                                                                    |     sendSegment.get(): ChannelSegment#2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                              |
|                                                                                                                                                                                    |     sendersAndCloseStatus.getAndIncrement(): 2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                       |
|                                                                                                                                                                                    |     BufferedChannel.updateCellSend(ChannelSegment#2, 2, 3, 2, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                        |
|                                                                                                                                                                                    |     $this.sendOnNoWaiterSuspend(ChannelSegment#2, 2, 3, 2) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                  |
|                                                                                                                                                                                    |       BufferedChannel.updateCellSend(ChannelSegment#2, 2, 3, 2, <continuation>#10, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                     |
|                                                                                                                                                                                    |       BufferedChannel.prepareSenderForSuspension(<continuation>#10, ChannelSegment#2, 2) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                         |
|                                                                                                                                                                                    |       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                            |
|                                                                                                                                                                                    |         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                           |
|                                                                                                                                                                                    |         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                            |
|                                                                                                                                                                                    |         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                       |
|                                                                                                                                                                                    |         installParentHandle(): ChildContinuation#5 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                    |
|                                                                                                                                                                                    |         switch (reason: coroutine is suspended)                                                                                                                                    |
|   counter ➜ 4 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                               |                                                                                                                                                                                    |
|   counter = 5 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                               |                                                                                                                                                                                    |
|   channel2.receive() (suspendable with <continuation>#4): 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:158)                 |                                                                                                                                                                                    |
|   counter ➜ 5 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:160)                                                               |                                                                                                                                                                                    |
|   result: IllegalStateException #1                                                                                                                                                 |                                                                                                                                                                                    |
|                                                                                                                                                                                    |   counter ➜ 5 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:170)                                                               |
|                                                                                                                                                                                    |   result: IllegalStateException #2                                                                                                                                                 |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

Exception stack traces:
#1: java.lang.IllegalStateException: Check failed.
	at org.jetbrains.kotlinx.lincheck_test.representation.MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:160)
	at org.jetbrains.kotlinx.lincheck_test.representation.MultipleSuspensionPointsChannelsTraceRepresentationTest$operation1$1.invokeSuspend(MultipleSuspensionsTests.kt)
	at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt:33)
	at java.base/java.lang.Thread.run(Thread.java:829)

#2: java.lang.IllegalStateException: Check failed.
	at org.jetbrains.kotlinx.lincheck_test.representation.MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:170)
	at org.jetbrains.kotlinx.lincheck_test.representation.MultipleSuspensionPointsChannelsTraceRepresentationTest$operation2$1.invokeSuspend(MultipleSuspensionsTests.kt)
	at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt:33)
	at java.base/java.lang.Thread.run(Thread.java:829)

Detailed trace:
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                          Thread 1                                                                                          |                                                                                          Thread 2                                                                                          |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                                                                            | operation2(): IllegalStateException #2                                                                                                                                                     |
|                                                                                                                                                                                            |   channel1.receive() (suspendable with <continuation>#1): 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:166)                         |
|                                                                                                                                                                                            |     receiveSegment.get(): ChannelSegment#1 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                |
|                                                                                                                                                                                            |     this_$iv.isClosedForReceive(): false at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                  |
|                                                                                                                                                                                            |       sendersAndCloseStatus.get(): 0 at BufferedChannel.isClosedForReceive(BufferedChannel.kt:2188)                                                                                        |
|                                                                                                                                                                                            |     receivers.getAndIncrement(): 0 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                        |
|                                                                                                                                                                                            |     BufferedChannel.updateCellReceive(ChannelSegment#1, 0, 0, null): <SUSPEND_NO_WAITER> at BufferedChannel.receive(BufferedChannel.kt:0)                                                  |
|                                                                                                                                                                                            |       segment.getState$kotlinx_coroutines_core(0): null at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                                       |
|                                                                                                                                                                                            |         data[1].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                    |
|                                                                                                                                                                                            |       sendersAndCloseStatus.get(): 0 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1007)                                                                                         |
|                                                                                                                                                                                            |     $this.receiveOnNoWaiterSuspend(ChannelSegment#1, 0, 0) (suspendable with <continuation>#1): 1 at BufferedChannel.receive(BufferedChannel.kt:0)                                         |
|                                                                                                                                                                                            |       BufferedChannel.updateCellReceive(ChannelSegment#1, 0, 0) (suspendable with <continuation>#3): 1 at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:3575)                |
|                                                                                                                                                                                            |         segment.getState$kotlinx_coroutines_core(0): null at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                                     |
|                                                                                                                                                                                            |           data[1].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                  |
|                                                                                                                                                                                            |         sendersAndCloseStatus.get(): 0 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1007)                                                                                       |
|                                                                                                                                                                                            |         switch                                                                                                                                                                             |
| operation1(): IllegalStateException #1                                                                                                                                                     |                                                                                                                                                                                            |
|   channel1.send(1) (suspendable with <continuation>#4) at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:156)                              |                                                                                                                                                                                            |
|     sendSegment.get(): ChannelSegment#1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                                      |                                                                                                                                                                                            |
|     sendersAndCloseStatus.getAndIncrement(): 0 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                               |                                                                                                                                                                                            |
|     BufferedChannel.updateCellSend(ChannelSegment#1, 0, 1, 0, null, false): 1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                |                                                                                                                                                                                            |
|       segment.storeElement$kotlinx_coroutines_core(0, 1) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                         |                                                                                                                                                                                            |
|         setElementLazy(0, 1) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                               |                                                                                                                                                                                            |
|           data[0].lazySet(1) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                     |                                                                                                                                                                                            |
|       segment.getState$kotlinx_coroutines_core(0): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                          |                                                                                                                                                                                            |
|         data[1].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                    |                                                                                                                                                                                            |
|       bufferOrRendezvousSend(0): true at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                            |                                                                                                                                                                                            |
|         getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                         |                                                                                                                                                                                            |
|           bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                                 |                                                                                                                                                                                            |
|         getReceiversCounter$kotlinx_coroutines_core(): 1 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                 |                                                                                                                                                                                            |
|           receivers.get(): 1 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                         |                                                                                                                                                                                            |
|       segment.casState$kotlinx_coroutines_core(0, null, <BUFFERED>): true at BufferedChannel.updateCellSend(BufferedChannel.kt:434)                                                        |                                                                                                                                                                                            |
|         data[1].compareAndSet(null, <BUFFERED>): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                                          |                                                                                                                                                                                            |
|   counter ➜ 0 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                                       |                                                                                                                                                                                            |
|   switch                                                                                                                                                                                   |                                                                                                                                                                                            |
|                                                                                                                                                                                            |         segment.casState$kotlinx_coroutines_core(0, null) (suspendable with <continuation>#3): false at BufferedChannel.updateCellReceive(BufferedChannel.kt:1016)                         |
|                                                                                                                                                                                            |           data[1].compareAndSet(null) (suspendable with <continuation>#3): false at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                               |
|                                                                                                                                                                                            |         updateCellReceiveSlow(ChannelSegment#1, 0, 0) (suspendable with <continuation>#3): 1 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1031)                                 |
|                                                                                                                                                                                            |           segment.getState$kotlinx_coroutines_core(0): <BUFFERED> at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1048)                                                        |
|                                                                                                                                                                                            |             data[1].get(): <BUFFERED> at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                          |
|                                                                                                                                                                                            |           segment.casState$kotlinx_coroutines_core(0, <BUFFERED>, <DONE_RCV>): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1085)                                      |
|                                                                                                                                                                                            |             data[1].compareAndSet(<BUFFERED>, <DONE_RCV>): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                                |
|                                                                                                                                                                                            |           expandBuffer() at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1087)                                                                                                 |
|                                                                                                                                                                                            |             isRendezvousOrUnlimited(): true at BufferedChannel.expandBuffer(BufferedChannel.kt:1173)                                                                                       |
|                                                                                                                                                                                            |               getBufferEndCounter(): 0 at BufferedChannel.isRendezvousOrUnlimited(BufferedChannel.kt:90)                                                                                   |
|                                                                                                                                                                                            |                 bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                           |
|                                                                                                                                                                                            |           segment.retrieveElement$kotlinx_coroutines_core(0): 1 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1088)                                                          |
|                                                                                                                                                                                            |             getElement$kotlinx_coroutines_core(0): 1 at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                    |
|                                                                                                                                                                                            |               data[0].get(): 1 at ChannelSegment.getElement$kotlinx_coroutines_core(BufferedChannel.kt:2757)                                                                               |
|                                                                                                                                                                                            |             cleanElement$kotlinx_coroutines_core(0) at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                     |
|                                                                                                                                                                                            |               setElementLazy(0, null) at ChannelSegment.cleanElement$kotlinx_coroutines_core(BufferedChannel.kt:2762)                                                                      |
|                                                                                                                                                                                            |                 data[0].lazySet(null) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                            |
|                                                                                                                                                                                            |       segment.cleanPrev() at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:3636)                                                                                             |
|                                                                                                                                                                                            |         _prev.lazySet(null) at ConcurrentLinkedListNode.cleanPrev(ConcurrentLinkedList.kt:132)                                                                                             |
|                                                                                                                                                                                            |       cont.resume(1, null) at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:709)                                                                                             |
|                                                                                                                                                                                            |         resumeMode ➜ 1 at CancellableContinuationImpl.resume(CancellableContinuationImpl.kt:371)                                                                                           |
|                                                                                                                                                                                            |         resumeImpl(1, 1, null) at CancellableContinuationImpl.resume(CancellableContinuationImpl.kt:371)                                                                                   |
|                                                                                                                                                                                            |           _state.get(): Active#1 at CancellableContinuationImpl.resumeImpl(CancellableContinuationImpl.kt:0)                                                                               |
|                                                                                                                                                                                            |           _state.compareAndSet(Active#1, 1): true at CancellableContinuationImpl.resumeImpl(CancellableContinuationImpl.kt:506)                                                            |
|                                                                                                                                                                                            |           detachChildIfNonResuable() at CancellableContinuationImpl.resumeImpl(CancellableContinuationImpl.kt:507)                                                                         |
|                                                                                                                                                                                            |             isReusable(): false at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                                |
|                                                                                                                                                                                            |               resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                 |
|                                                                                                                                                                                            |             detachChild$kotlinx_coroutines_core() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                              |
|                                                                                                                                                                                            |               getParentHandle(): null at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:572)                                               |
|                                                                                                                                                                                            |                 _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                               |
|                                                                                                                                                                                            |           dispatchResume(1) at CancellableContinuationImpl.resumeImpl(CancellableContinuationImpl.kt:508)                                                                                  |
|                                                                                                                                                                                            |             tryResume(): true at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                            |
|                                                                                                                                                                                            |               _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                                |
|                                                                                                                                                                                            |               _decisionAndIndex.compareAndSet(536870911, 1610612735): true at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:288)                                    |
|                                                                                                                                                                                            |       cancellable$iv.getResult(): 1 at BufferedChannel.receiveOnNoWaiterSuspend(BufferedChannel.kt:3648)                                                                                   |
|                                                                                                                                                                                            |         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                   |
|                                                                                                                                                                                            |           resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                     |
|                                                                                                                                                                                            |         trySuspend(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                   |
|                                                                                                                                                                                            |           _decisionAndIndex.get(): 1610612735 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                  |
|                                                                                                                                                                                            |         getState$kotlinx_coroutines_core(): 1 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:328)                                                                 |
|                                                                                                                                                                                            |           _state.get(): 1 at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                                              |
|                                                                                                                                                                                            |         resumeMode ➜ 1 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:334)                                                                                        |
|                                                                                                                                                                                            |   counter ➜ 0 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                                       |
|                                                                                                                                                                                            |   counter = 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                                       |
|                                                                                                                                                                                            |   channel2.send(1) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:168)         |
|                                                                                                                                                                                            |     sendSegment.get(): ChannelSegment#2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                                      |
|                                                                                                                                                                                            |     sendersAndCloseStatus.getAndIncrement(): 0 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                               |
|                                                                                                                                                                                            |     BufferedChannel.updateCellSend(ChannelSegment#2, 0, 1, 0, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                                |
|                                                                                                                                                                                            |       segment.storeElement$kotlinx_coroutines_core(0, 1) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                         |
|                                                                                                                                                                                            |         setElementLazy(0, 1) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                               |
|                                                                                                                                                                                            |           data[0].lazySet(1) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                     |
|                                                                                                                                                                                            |       segment.getState$kotlinx_coroutines_core(0): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                          |
|                                                                                                                                                                                            |         data[1].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                    |
|                                                                                                                                                                                            |       bufferOrRendezvousSend(0): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                           |
|                                                                                                                                                                                            |         getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                         |
|                                                                                                                                                                                            |           bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                                 |
|                                                                                                                                                                                            |         getReceiversCounter$kotlinx_coroutines_core(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                 |
|                                                                                                                                                                                            |           receivers.get(): 0 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                         |
|                                                                                                                                                                                            |     $this.sendOnNoWaiterSuspend(ChannelSegment#2, 0, 1, 0) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                          |
|                                                                                                                                                                                            |       BufferedChannel.updateCellSend(ChannelSegment#2, 0, 1, 0, <continuation>#5, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                              |
|                                                                                                                                                                                            |         segment.storeElement$kotlinx_coroutines_core(0, 1) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                       |
|                                                                                                                                                                                            |           setElementLazy(0, 1) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                             |
|                                                                                                                                                                                            |             data[0].lazySet(1) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                   |
|                                                                                                                                                                                            |         segment.getState$kotlinx_coroutines_core(0): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                        |
|                                                                                                                                                                                            |           data[1].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                  |
|                                                                                                                                                                                            |         bufferOrRendezvousSend(0): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                         |
|                                                                                                                                                                                            |           getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                       |
|                                                                                                                                                                                            |             bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                               |
|                                                                                                                                                                                            |           getReceiversCounter$kotlinx_coroutines_core(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                               |
|                                                                                                                                                                                            |             receivers.get(): 0 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                       |
|                                                                                                                                                                                            |         segment.casState$kotlinx_coroutines_core(0, null) (suspendable with <continuation>#5): true at BufferedChannel.updateCellSend(BufferedChannel.kt:448)                              |
|                                                                                                                                                                                            |           data[1].compareAndSet(null) (suspendable with <continuation>#5): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                |
|                                                                                                                                                                                            |       BufferedChannel.prepareSenderForSuspension(<continuation>#5, ChannelSegment#2, 0) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                                  |
|                                                                                                                                                                                            |         $this$prepareSenderForSuspension.invokeOnCancellation(ChannelSegment#2, 32) at BufferedChannel.prepareSenderForSuspension(BufferedChannel.kt:178)                                  |
|                                                                                                                                                                                            |           _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:0)                                                         |
|                                                                                                                                                                                            |           _decisionAndIndex.compareAndSet(536870911, 32): true at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                     |
|                                                                                                                                                                                            |           invokeOnCancellationImpl(ChannelSegment#2) at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:394)                                               |
|                                                                                                                                                                                            |             _state.get(): Active#1 at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                             |
|                                                                                                                                                                                            |             _state.compareAndSet(Active#1, ChannelSegment#2): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:407)                             |
|                                                                                                                                                                                            |       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                                    |
|                                                                                                                                                                                            |         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                   |
|                                                                                                                                                                                            |           resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                     |
|                                                                                                                                                                                            |         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                    |
|                                                                                                                                                                                            |           _decisionAndIndex.get(): 32 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                          |
|                                                                                                                                                                                            |           _decisionAndIndex.compareAndSet(32, 536870944): true at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                               |
|                                                                                                                                                                                            |         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                               |
|                                                                                                                                                                                            |           _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                                     |
|                                                                                                                                                                                            |         installParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                            |
|                                                                                                                                                                                            |           Job$DefaultImpls.invokeOnCompletion(true, true, ChildContinuation#1): ChildContinuation#1 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:348) |
|                                                                                                                                                                                            |             ChildContinuation#1.job = JobImpl#1 at JobNode.setJob(JobSupport.kt:1348)                                                                                                      |
|                                                                                                                                                                                            |           _parentHandle.compareAndSet(null, ChildContinuation#1): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                              |
|                                                                                                                                                                                            |         switch (reason: coroutine is suspended)                                                                                                                                            |
|   counter = 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                                       |                                                                                                                                                                                            |
|   channel2.receive() (suspendable with <continuation>#4): 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:158)                         |                                                                                                                                                                                            |
|     receiveSegment.get(): ChannelSegment#2 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                |                                                                                                                                                                                            |
|     this_$iv.isClosedForReceive(): false at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                  |                                                                                                                                                                                            |
|       sendersAndCloseStatus.get(): 1 at BufferedChannel.isClosedForReceive(BufferedChannel.kt:2188)                                                                                        |                                                                                                                                                                                            |
|     receivers.getAndIncrement(): 0 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                        |                                                                                                                                                                                            |
|     BufferedChannel.updateCellReceive(ChannelSegment#2, 0, 0, null): 1 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                    |                                                                                                                                                                                            |
|       segment.getState$kotlinx_coroutines_core(0): <continuation>#5 at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                           |                                                                                                                                                                                            |
|         data[1].get(): <continuation>#5 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                        |                                                                                                                                                                                            |
|       updateCellReceiveSlow(ChannelSegment#2, 0, 0, null): 1 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1031)                                                                 |                                                                                                                                                                                            |
|         segment.getState$kotlinx_coroutines_core(0): <continuation>#5 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1048)                                                    |                                                                                                                                                                                            |
|           data[1].get(): <continuation>#5 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                      |                                                                                                                                                                                            |
|         segment.casState$kotlinx_coroutines_core(0, <continuation>#5, <S_RESUMING_BY_RCV>): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1115)                         |                                                                                                                                                                                            |
|           data[1].compareAndSet(<continuation>#5, <S_RESUMING_BY_RCV>): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                   |                                                                                                                                                                                            |
|         tryResumeSender(<continuation>#5, ChannelSegment#2, 0): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1120)                                                     |                                                                                                                                                                                            |
|           BufferedChannelKt.tryResume0(<continuation>#5, Unit, null): true at BufferedChannel.tryResumeSender(BufferedChannel.kt:1151)                                                     |                                                                                                                                                                                            |
|             $this$tryResume0.tryResume(Unit, null, null): <RESUME_TOKEN> at BufferedChannelKt.tryResume0(BufferedChannel.kt:2894)                                                          |                                                                                                                                                                                            |
|               tryResumeImpl(Unit, null, null): <RESUME_TOKEN> at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:582)                                                 |                                                                                                                                                                                            |
|                 _state.get(): ChannelSegment#2 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:0)                                                              |                                                                                                                                                                                            |
|                 resumeMode ➜ 1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:540)                                                                            |                                                                                                                                                                                            |
|                 _state.compareAndSet(ChannelSegment#2, Unit): true at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:541)                                        |                                                                                                                                                                                            |
|                 detachChildIfNonResuable() at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:542)                                                                |                                                                                                                                                                                            |
|                   isReusable(): false at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                          |                                                                                                                                                                                            |
|                     resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                           |                                                                                                                                                                                            |
|                   detachChild$kotlinx_coroutines_core() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                        |                                                                                                                                                                                            |
|                     getParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:572)                          |                                                                                                                                                                                            |
|                       _parentHandle.get(): ChildContinuation#1 at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                          |                                                                                                                                                                                            |
|                     handle.dispose() at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:573)                                                |                                                                                                                                                                                            |
|                       getJob(): JobImpl#1 at JobNode.dispose(JobSupport.kt:1351)                                                                                                           |                                                                                                                                                                                            |
|                         job ➜ JobImpl#1 at JobNode.getJob(JobSupport.kt:1348)                                                                                                              |                                                                                                                                                                                            |
|                     _parentHandle.set(NonDisposableHandle#1) at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:574)                        |                                                                                                                                                                                            |
|             $this$tryResume0.completeResume(<RESUME_TOKEN>) at BufferedChannelKt.tryResume0(BufferedChannel.kt:2896)                                                                       |                                                                                                                                                                                            |
|               resumeMode ➜ 1 at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                             |                                                                                                                                                                                            |
|               dispatchResume(1) at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                          |                                                                                                                                                                                            |
|                 tryResume(): false at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                       |                                                                                                                                                                                            |
|                   _decisionAndIndex.get(): 536870944 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                            |                                                                                                                                                                                            |
|                 DispatchedTaskKt.dispatch(<continuation>#5, 1) at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:474)                                           |                                                                                                                                                                                            |
|                   DispatchedTaskKt.resume(<continuation>#5, <continuation>#2, false) at DispatchedTaskKt.dispatch(DispatchedTask.kt:168)                                                   |                                                                                                                                                                                            |
|                     $this$resume.takeState$kotlinx_coroutines_core() at DispatchedTaskKt.resume(DispatchedTask.kt:174)                                                                     |                                                                                                                                                                                            |
|                       getState$kotlinx_coroutines_core() at CancellableContinuationImpl.takeState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:168)                              |                                                                                                                                                                                            |
|                         _state.get() at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                                   |                                                                                                                                                                                            |
|         segment.setState$kotlinx_coroutines_core(0, <DONE_RCV>) at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1128)                                                          |                                                                                                                                                                                            |
|           data[1].set(<DONE_RCV>) at ChannelSegment.setState$kotlinx_coroutines_core(BufferedChannel.kt:2776)                                                                              |                                                                                                                                                                                            |
|         expandBuffer() at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1129)                                                                                                   |                                                                                                                                                                                            |
|           isRendezvousOrUnlimited(): true at BufferedChannel.expandBuffer(BufferedChannel.kt:1173)                                                                                         |                                                                                                                                                                                            |
|             getBufferEndCounter(): 0 at BufferedChannel.isRendezvousOrUnlimited(BufferedChannel.kt:90)                                                                                     |                                                                                                                                                                                            |
|               bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                             |                                                                                                                                                                                            |
|         segment.retrieveElement$kotlinx_coroutines_core(0): 1 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1130)                                                            |                                                                                                                                                                                            |
|           getElement$kotlinx_coroutines_core(0): 1 at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                      |                                                                                                                                                                                            |
|             data[0].get(): 1 at ChannelSegment.getElement$kotlinx_coroutines_core(BufferedChannel.kt:2757)                                                                                 |                                                                                                                                                                                            |
|           cleanElement$kotlinx_coroutines_core(0) at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                       |                                                                                                                                                                                            |
|             setElementLazy(0, null) at ChannelSegment.cleanElement$kotlinx_coroutines_core(BufferedChannel.kt:2762)                                                                        |                                                                                                                                                                                            |
|               data[0].lazySet(null) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                              |                                                                                                                                                                                            |
|     segment$iv.cleanPrev() at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                                |                                                                                                                                                                                            |
|       _prev.lazySet(null) at ConcurrentLinkedListNode.cleanPrev(ConcurrentLinkedList.kt:132)                                                                                               |                                                                                                                                                                                            |
|   channel1.send(2) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:156)         |                                                                                                                                                                                            |
|     sendSegment.get(): ChannelSegment#1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                                      |                                                                                                                                                                                            |
|     sendersAndCloseStatus.getAndIncrement(): 1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                               |                                                                                                                                                                                            |
|     BufferedChannel.updateCellSend(ChannelSegment#1, 1, 2, 1, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                                |                                                                                                                                                                                            |
|       segment.storeElement$kotlinx_coroutines_core(1, 2) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                         |                                                                                                                                                                                            |
|         setElementLazy(1, 2) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                               |                                                                                                                                                                                            |
|           data[2].lazySet(2) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                     |                                                                                                                                                                                            |
|       segment.getState$kotlinx_coroutines_core(1): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                          |                                                                                                                                                                                            |
|         data[3].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                    |                                                                                                                                                                                            |
|       bufferOrRendezvousSend(1): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                           |                                                                                                                                                                                            |
|         getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                         |                                                                                                                                                                                            |
|           bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                                 |                                                                                                                                                                                            |
|         getReceiversCounter$kotlinx_coroutines_core(): 1 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                 |                                                                                                                                                                                            |
|           receivers.get(): 1 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                         |                                                                                                                                                                                            |
|     $this.sendOnNoWaiterSuspend(ChannelSegment#1, 1, 2, 1) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                          |                                                                                                                                                                                            |
|       BufferedChannel.updateCellSend(ChannelSegment#1, 1, 2, 1, <continuation>#7, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                              |                                                                                                                                                                                            |
|         segment.storeElement$kotlinx_coroutines_core(1, 2) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                       |                                                                                                                                                                                            |
|           setElementLazy(1, 2) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                             |                                                                                                                                                                                            |
|             data[2].lazySet(2) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                   |                                                                                                                                                                                            |
|         segment.getState$kotlinx_coroutines_core(1): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                        |                                                                                                                                                                                            |
|           data[3].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                  |                                                                                                                                                                                            |
|         bufferOrRendezvousSend(1): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                         |                                                                                                                                                                                            |
|           getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                       |                                                                                                                                                                                            |
|             bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                               |                                                                                                                                                                                            |
|           getReceiversCounter$kotlinx_coroutines_core(): 1 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                               |                                                                                                                                                                                            |
|             receivers.get(): 1 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                       |                                                                                                                                                                                            |
|         segment.casState$kotlinx_coroutines_core(1, null) (suspendable with <continuation>#7): true at BufferedChannel.updateCellSend(BufferedChannel.kt:448)                              |                                                                                                                                                                                            |
|           data[3].compareAndSet(null) (suspendable with <continuation>#7): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                |                                                                                                                                                                                            |
|       BufferedChannel.prepareSenderForSuspension(<continuation>#7, ChannelSegment#1, 1) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                                  |                                                                                                                                                                                            |
|         $this$prepareSenderForSuspension.invokeOnCancellation(ChannelSegment#1, 33) at BufferedChannel.prepareSenderForSuspension(BufferedChannel.kt:178)                                  |                                                                                                                                                                                            |
|           _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:0)                                                         |                                                                                                                                                                                            |
|           _decisionAndIndex.compareAndSet(536870911, 33): true at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                     |                                                                                                                                                                                            |
|           invokeOnCancellationImpl(ChannelSegment#1) at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:394)                                               |                                                                                                                                                                                            |
|             _state.get(): Active#1 at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                             |                                                                                                                                                                                            |
|             _state.compareAndSet(Active#1, ChannelSegment#1): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:407)                             |                                                                                                                                                                                            |
|       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                                    |                                                                                                                                                                                            |
|         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                   |                                                                                                                                                                                            |
|           resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                     |                                                                                                                                                                                            |
|         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                    |                                                                                                                                                                                            |
|           _decisionAndIndex.get(): 33 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                          |                                                                                                                                                                                            |
|           _decisionAndIndex.compareAndSet(33, 536870945): true at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                               |                                                                                                                                                                                            |
|         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                               |                                                                                                                                                                                            |
|           _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                                     |                                                                                                                                                                                            |
|         installParentHandle(): ChildContinuation#2 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                            |                                                                                                                                                                                            |
|           Job$DefaultImpls.invokeOnCompletion(true, true, ChildContinuation#2): ChildContinuation#2 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:348) |                                                                                                                                                                                            |
|             ChildContinuation#2.job = JobImpl#2 at JobNode.setJob(JobSupport.kt:1348)                                                                                                      |                                                                                                                                                                                            |
|           _parentHandle.compareAndSet(null, ChildContinuation#2): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                              |                                                                                                                                                                                            |
|         switch (reason: coroutine is suspended)                                                                                                                                            |                                                                                                                                                                                            |
|                                                                                                                                                                                            |   channel1.receive() (suspendable with <continuation>#1): 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:166)                         |
|                                                                                                                                                                                            |     receiveSegment.get(): ChannelSegment#1 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                |
|                                                                                                                                                                                            |     this_$iv.isClosedForReceive(): false at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                  |
|                                                                                                                                                                                            |       sendersAndCloseStatus.get(): 2 at BufferedChannel.isClosedForReceive(BufferedChannel.kt:2188)                                                                                        |
|                                                                                                                                                                                            |     receivers.getAndIncrement(): 1 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                        |
|                                                                                                                                                                                            |     BufferedChannel.updateCellReceive(ChannelSegment#1, 1, 1, null): 2 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                    |
|                                                                                                                                                                                            |       segment.getState$kotlinx_coroutines_core(1): <continuation>#7 at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                           |
|                                                                                                                                                                                            |         data[3].get(): <continuation>#7 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                        |
|                                                                                                                                                                                            |       updateCellReceiveSlow(ChannelSegment#1, 1, 1, null): 2 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1031)                                                                 |
|                                                                                                                                                                                            |         segment.getState$kotlinx_coroutines_core(1): <continuation>#7 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1048)                                                    |
|                                                                                                                                                                                            |           data[3].get(): <continuation>#7 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                      |
|                                                                                                                                                                                            |         segment.casState$kotlinx_coroutines_core(1, <continuation>#7, <S_RESUMING_BY_RCV>): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1115)                         |
|                                                                                                                                                                                            |           data[3].compareAndSet(<continuation>#7, <S_RESUMING_BY_RCV>): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                   |
|                                                                                                                                                                                            |         tryResumeSender(<continuation>#7, ChannelSegment#1, 1): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1120)                                                     |
|                                                                                                                                                                                            |           BufferedChannelKt.tryResume0(<continuation>#7, Unit, null): true at BufferedChannel.tryResumeSender(BufferedChannel.kt:1151)                                                     |
|                                                                                                                                                                                            |             $this$tryResume0.tryResume(Unit, null, null): <RESUME_TOKEN> at BufferedChannelKt.tryResume0(BufferedChannel.kt:2894)                                                          |
|                                                                                                                                                                                            |               tryResumeImpl(Unit, null, null): <RESUME_TOKEN> at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:582)                                                 |
|                                                                                                                                                                                            |                 _state.get(): ChannelSegment#1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:0)                                                              |
|                                                                                                                                                                                            |                 resumeMode ➜ 1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:540)                                                                            |
|                                                                                                                                                                                            |                 _state.compareAndSet(ChannelSegment#1, Unit): true at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:541)                                        |
|                                                                                                                                                                                            |                 detachChildIfNonResuable() at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:542)                                                                |
|                                                                                                                                                                                            |                   isReusable(): false at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                          |
|                                                                                                                                                                                            |                     resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                           |
|                                                                                                                                                                                            |                   detachChild$kotlinx_coroutines_core() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                        |
|                                                                                                                                                                                            |                     getParentHandle(): ChildContinuation#2 at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:572)                          |
|                                                                                                                                                                                            |                       _parentHandle.get(): ChildContinuation#2 at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                          |
|                                                                                                                                                                                            |                     handle.dispose() at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:573)                                                |
|                                                                                                                                                                                            |                       getJob(): JobImpl#2 at JobNode.dispose(JobSupport.kt:1351)                                                                                                           |
|                                                                                                                                                                                            |                         job ➜ JobImpl#2 at JobNode.getJob(JobSupport.kt:1348)                                                                                                              |
|                                                                                                                                                                                            |                     _parentHandle.set(NonDisposableHandle#1) at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:574)                        |
|                                                                                                                                                                                            |             $this$tryResume0.completeResume(<RESUME_TOKEN>) at BufferedChannelKt.tryResume0(BufferedChannel.kt:2896)                                                                       |
|                                                                                                                                                                                            |               resumeMode ➜ 1 at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                             |
|                                                                                                                                                                                            |               dispatchResume(1) at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                          |
|                                                                                                                                                                                            |                 tryResume(): false at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                       |
|                                                                                                                                                                                            |                   _decisionAndIndex.get(): 536870945 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                            |
|                                                                                                                                                                                            |                 DispatchedTaskKt.dispatch(<continuation>#7, 1) at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:474)                                           |
|                                                                                                                                                                                            |                   DispatchedTaskKt.resume(<continuation>#7, <continuation>#6, false) at DispatchedTaskKt.dispatch(DispatchedTask.kt:168)                                                   |
|                                                                                                                                                                                            |                     $this$resume.takeState$kotlinx_coroutines_core() at DispatchedTaskKt.resume(DispatchedTask.kt:174)                                                                     |
|                                                                                                                                                                                            |                       getState$kotlinx_coroutines_core() at CancellableContinuationImpl.takeState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:168)                              |
|                                                                                                                                                                                            |                         _state.get() at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                                   |
|                                                                                                                                                                                            |         segment.setState$kotlinx_coroutines_core(1, <DONE_RCV>) at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1128)                                                          |
|                                                                                                                                                                                            |           data[3].set(<DONE_RCV>) at ChannelSegment.setState$kotlinx_coroutines_core(BufferedChannel.kt:2776)                                                                              |
|                                                                                                                                                                                            |         expandBuffer() at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1129)                                                                                                   |
|                                                                                                                                                                                            |           isRendezvousOrUnlimited(): true at BufferedChannel.expandBuffer(BufferedChannel.kt:1173)                                                                                         |
|                                                                                                                                                                                            |             getBufferEndCounter(): 0 at BufferedChannel.isRendezvousOrUnlimited(BufferedChannel.kt:90)                                                                                     |
|                                                                                                                                                                                            |               bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                             |
|                                                                                                                                                                                            |         segment.retrieveElement$kotlinx_coroutines_core(1): 2 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1130)                                                            |
|                                                                                                                                                                                            |           getElement$kotlinx_coroutines_core(1): 2 at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                      |
|                                                                                                                                                                                            |             data[2].get(): 2 at ChannelSegment.getElement$kotlinx_coroutines_core(BufferedChannel.kt:2757)                                                                                 |
|                                                                                                                                                                                            |           cleanElement$kotlinx_coroutines_core(1) at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                       |
|                                                                                                                                                                                            |             setElementLazy(1, null) at ChannelSegment.cleanElement$kotlinx_coroutines_core(BufferedChannel.kt:2762)                                                                        |
|                                                                                                                                                                                            |               data[2].lazySet(null) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                              |
|                                                                                                                                                                                            |     segment$iv.cleanPrev() at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                                |
|                                                                                                                                                                                            |       _prev.lazySet(null) at ConcurrentLinkedListNode.cleanPrev(ConcurrentLinkedList.kt:132)                                                                                               |
|                                                                                                                                                                                            |   counter ➜ 1 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                                       |
|                                                                                                                                                                                            |   counter = 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                                       |
|                                                                                                                                                                                            |   channel2.send(2) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:168)         |
|                                                                                                                                                                                            |     sendSegment.get(): ChannelSegment#2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                                      |
|                                                                                                                                                                                            |     sendersAndCloseStatus.getAndIncrement(): 1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                               |
|                                                                                                                                                                                            |     BufferedChannel.updateCellSend(ChannelSegment#2, 1, 2, 1, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                                |
|                                                                                                                                                                                            |       segment.storeElement$kotlinx_coroutines_core(1, 2) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                         |
|                                                                                                                                                                                            |         setElementLazy(1, 2) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                               |
|                                                                                                                                                                                            |           data[2].lazySet(2) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                     |
|                                                                                                                                                                                            |       segment.getState$kotlinx_coroutines_core(1): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                          |
|                                                                                                                                                                                            |         data[3].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                    |
|                                                                                                                                                                                            |       bufferOrRendezvousSend(1): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                           |
|                                                                                                                                                                                            |         getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                         |
|                                                                                                                                                                                            |           bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                                 |
|                                                                                                                                                                                            |         getReceiversCounter$kotlinx_coroutines_core(): 1 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                 |
|                                                                                                                                                                                            |           receivers.get(): 1 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                         |
|                                                                                                                                                                                            |     $this.sendOnNoWaiterSuspend(ChannelSegment#2, 1, 2, 1) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                          |
|                                                                                                                                                                                            |       BufferedChannel.updateCellSend(ChannelSegment#2, 1, 2, 1, <continuation>#8, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                              |
|                                                                                                                                                                                            |         segment.storeElement$kotlinx_coroutines_core(1, 2) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                       |
|                                                                                                                                                                                            |           setElementLazy(1, 2) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                             |
|                                                                                                                                                                                            |             data[2].lazySet(2) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                   |
|                                                                                                                                                                                            |         segment.getState$kotlinx_coroutines_core(1): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                        |
|                                                                                                                                                                                            |           data[3].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                  |
|                                                                                                                                                                                            |         bufferOrRendezvousSend(1): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                         |
|                                                                                                                                                                                            |           getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                       |
|                                                                                                                                                                                            |             bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                               |
|                                                                                                                                                                                            |           getReceiversCounter$kotlinx_coroutines_core(): 1 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                               |
|                                                                                                                                                                                            |             receivers.get(): 1 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                       |
|                                                                                                                                                                                            |         segment.casState$kotlinx_coroutines_core(1, null) (suspendable with <continuation>#8): true at BufferedChannel.updateCellSend(BufferedChannel.kt:448)                              |
|                                                                                                                                                                                            |           data[3].compareAndSet(null) (suspendable with <continuation>#8): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                |
|                                                                                                                                                                                            |       BufferedChannel.prepareSenderForSuspension(<continuation>#8, ChannelSegment#2, 1) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                                  |
|                                                                                                                                                                                            |         $this$prepareSenderForSuspension.invokeOnCancellation(ChannelSegment#2, 33) at BufferedChannel.prepareSenderForSuspension(BufferedChannel.kt:178)                                  |
|                                                                                                                                                                                            |           _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:0)                                                         |
|                                                                                                                                                                                            |           _decisionAndIndex.compareAndSet(536870911, 33): true at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                     |
|                                                                                                                                                                                            |           invokeOnCancellationImpl(ChannelSegment#2) at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:394)                                               |
|                                                                                                                                                                                            |             _state.get(): Active#1 at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                             |
|                                                                                                                                                                                            |             _state.compareAndSet(Active#1, ChannelSegment#2): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:407)                             |
|                                                                                                                                                                                            |       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                                    |
|                                                                                                                                                                                            |         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                   |
|                                                                                                                                                                                            |           resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                     |
|                                                                                                                                                                                            |         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                    |
|                                                                                                                                                                                            |           _decisionAndIndex.get(): 33 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                          |
|                                                                                                                                                                                            |           _decisionAndIndex.compareAndSet(33, 536870945): true at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                               |
|                                                                                                                                                                                            |         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                               |
|                                                                                                                                                                                            |           _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                                     |
|                                                                                                                                                                                            |         installParentHandle(): ChildContinuation#3 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                            |
|                                                                                                                                                                                            |           Job$DefaultImpls.invokeOnCompletion(true, true, ChildContinuation#3): ChildContinuation#3 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:348) |
|                                                                                                                                                                                            |             ChildContinuation#3.job = JobImpl#1 at JobNode.setJob(JobSupport.kt:1348)                                                                                                      |
|                                                                                                                                                                                            |           _parentHandle.compareAndSet(null, ChildContinuation#3): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                              |
|                                                                                                                                                                                            |         switch (reason: coroutine is suspended)                                                                                                                                            |
|   counter ➜ 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                                       |                                                                                                                                                                                            |
|   counter = 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                                       |                                                                                                                                                                                            |
|   channel2.receive() (suspendable with <continuation>#4): 2 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:158)                         |                                                                                                                                                                                            |
|     receiveSegment.get(): ChannelSegment#2 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                |                                                                                                                                                                                            |
|     this_$iv.isClosedForReceive(): false at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                  |                                                                                                                                                                                            |
|       sendersAndCloseStatus.get(): 2 at BufferedChannel.isClosedForReceive(BufferedChannel.kt:2188)                                                                                        |                                                                                                                                                                                            |
|     receivers.getAndIncrement(): 1 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                        |                                                                                                                                                                                            |
|     BufferedChannel.updateCellReceive(ChannelSegment#2, 1, 1, null): 2 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                    |                                                                                                                                                                                            |
|       segment.getState$kotlinx_coroutines_core(1): <continuation>#8 at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                           |                                                                                                                                                                                            |
|         data[3].get(): <continuation>#8 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                        |                                                                                                                                                                                            |
|       updateCellReceiveSlow(ChannelSegment#2, 1, 1, null): 2 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1031)                                                                 |                                                                                                                                                                                            |
|         segment.getState$kotlinx_coroutines_core(1): <continuation>#8 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1048)                                                    |                                                                                                                                                                                            |
|           data[3].get(): <continuation>#8 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                      |                                                                                                                                                                                            |
|         segment.casState$kotlinx_coroutines_core(1, <continuation>#8, <S_RESUMING_BY_RCV>): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1115)                         |                                                                                                                                                                                            |
|           data[3].compareAndSet(<continuation>#8, <S_RESUMING_BY_RCV>): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                   |                                                                                                                                                                                            |
|         tryResumeSender(<continuation>#8, ChannelSegment#2, 1): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1120)                                                     |                                                                                                                                                                                            |
|           BufferedChannelKt.tryResume0(<continuation>#8, Unit, null): true at BufferedChannel.tryResumeSender(BufferedChannel.kt:1151)                                                     |                                                                                                                                                                                            |
|             $this$tryResume0.tryResume(Unit, null, null): <RESUME_TOKEN> at BufferedChannelKt.tryResume0(BufferedChannel.kt:2894)                                                          |                                                                                                                                                                                            |
|               tryResumeImpl(Unit, null, null): <RESUME_TOKEN> at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:582)                                                 |                                                                                                                                                                                            |
|                 _state.get(): ChannelSegment#2 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:0)                                                              |                                                                                                                                                                                            |
|                 resumeMode ➜ 1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:540)                                                                            |                                                                                                                                                                                            |
|                 _state.compareAndSet(ChannelSegment#2, Unit): true at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:541)                                        |                                                                                                                                                                                            |
|                 detachChildIfNonResuable() at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:542)                                                                |                                                                                                                                                                                            |
|                   isReusable(): false at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                          |                                                                                                                                                                                            |
|                     resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                           |                                                                                                                                                                                            |
|                   detachChild$kotlinx_coroutines_core() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                        |                                                                                                                                                                                            |
|                     getParentHandle(): ChildContinuation#3 at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:572)                          |                                                                                                                                                                                            |
|                       _parentHandle.get(): ChildContinuation#3 at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                          |                                                                                                                                                                                            |
|                     handle.dispose() at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:573)                                                |                                                                                                                                                                                            |
|                       getJob(): JobImpl#1 at JobNode.dispose(JobSupport.kt:1351)                                                                                                           |                                                                                                                                                                                            |
|                         job ➜ JobImpl#1 at JobNode.getJob(JobSupport.kt:1348)                                                                                                              |                                                                                                                                                                                            |
|                     _parentHandle.set(NonDisposableHandle#1) at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:574)                        |                                                                                                                                                                                            |
|             $this$tryResume0.completeResume(<RESUME_TOKEN>) at BufferedChannelKt.tryResume0(BufferedChannel.kt:2896)                                                                       |                                                                                                                                                                                            |
|               resumeMode ➜ 1 at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                             |                                                                                                                                                                                            |
|               dispatchResume(1) at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                          |                                                                                                                                                                                            |
|                 tryResume(): false at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                       |                                                                                                                                                                                            |
|                   _decisionAndIndex.get(): 536870945 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                            |                                                                                                                                                                                            |
|                 DispatchedTaskKt.dispatch(<continuation>#8, 1) at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:474)                                           |                                                                                                                                                                                            |
|                   DispatchedTaskKt.resume(<continuation>#8, <continuation>#2, false) at DispatchedTaskKt.dispatch(DispatchedTask.kt:168)                                                   |                                                                                                                                                                                            |
|                     $this$resume.takeState$kotlinx_coroutines_core() at DispatchedTaskKt.resume(DispatchedTask.kt:174)                                                                     |                                                                                                                                                                                            |
|                       getState$kotlinx_coroutines_core() at CancellableContinuationImpl.takeState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:168)                              |                                                                                                                                                                                            |
|                         _state.get() at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                                   |                                                                                                                                                                                            |
|         segment.setState$kotlinx_coroutines_core(1, <DONE_RCV>) at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1128)                                                          |                                                                                                                                                                                            |
|           data[3].set(<DONE_RCV>) at ChannelSegment.setState$kotlinx_coroutines_core(BufferedChannel.kt:2776)                                                                              |                                                                                                                                                                                            |
|         expandBuffer() at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1129)                                                                                                   |                                                                                                                                                                                            |
|           isRendezvousOrUnlimited(): true at BufferedChannel.expandBuffer(BufferedChannel.kt:1173)                                                                                         |                                                                                                                                                                                            |
|             getBufferEndCounter(): 0 at BufferedChannel.isRendezvousOrUnlimited(BufferedChannel.kt:90)                                                                                     |                                                                                                                                                                                            |
|               bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                             |                                                                                                                                                                                            |
|         segment.retrieveElement$kotlinx_coroutines_core(1): 2 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1130)                                                            |                                                                                                                                                                                            |
|           getElement$kotlinx_coroutines_core(1): 2 at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                      |                                                                                                                                                                                            |
|             data[2].get(): 2 at ChannelSegment.getElement$kotlinx_coroutines_core(BufferedChannel.kt:2757)                                                                                 |                                                                                                                                                                                            |
|           cleanElement$kotlinx_coroutines_core(1) at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                       |                                                                                                                                                                                            |
|             setElementLazy(1, null) at ChannelSegment.cleanElement$kotlinx_coroutines_core(BufferedChannel.kt:2762)                                                                        |                                                                                                                                                                                            |
|               data[2].lazySet(null) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                              |                                                                                                                                                                                            |
|     segment$iv.cleanPrev() at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                                |                                                                                                                                                                                            |
|       _prev.lazySet(null) at ConcurrentLinkedListNode.cleanPrev(ConcurrentLinkedList.kt:132)                                                                                               |                                                                                                                                                                                            |
|   channel1.send(3) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:156)         |                                                                                                                                                                                            |
|     sendSegment.get(): ChannelSegment#1 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                                      |                                                                                                                                                                                            |
|     sendersAndCloseStatus.getAndIncrement(): 2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                               |                                                                                                                                                                                            |
|     BufferedChannel.updateCellSend(ChannelSegment#1, 2, 3, 2, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                                |                                                                                                                                                                                            |
|       segment.storeElement$kotlinx_coroutines_core(2, 3) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                         |                                                                                                                                                                                            |
|         setElementLazy(2, 3) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                               |                                                                                                                                                                                            |
|           data[4].lazySet(3) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                     |                                                                                                                                                                                            |
|       segment.getState$kotlinx_coroutines_core(2): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                          |                                                                                                                                                                                            |
|         data[5].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                    |                                                                                                                                                                                            |
|       bufferOrRendezvousSend(2): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                           |                                                                                                                                                                                            |
|         getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                         |                                                                                                                                                                                            |
|           bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                                 |                                                                                                                                                                                            |
|         getReceiversCounter$kotlinx_coroutines_core(): 2 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                 |                                                                                                                                                                                            |
|           receivers.get(): 2 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                         |                                                                                                                                                                                            |
|     $this.sendOnNoWaiterSuspend(ChannelSegment#1, 2, 3, 2) (suspendable with <continuation>#4): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                          |                                                                                                                                                                                            |
|       BufferedChannel.updateCellSend(ChannelSegment#1, 2, 3, 2, <continuation>#9, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                              |                                                                                                                                                                                            |
|         segment.storeElement$kotlinx_coroutines_core(2, 3) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                       |                                                                                                                                                                                            |
|           setElementLazy(2, 3) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                             |                                                                                                                                                                                            |
|             data[4].lazySet(3) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                   |                                                                                                                                                                                            |
|         segment.getState$kotlinx_coroutines_core(2): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                        |                                                                                                                                                                                            |
|           data[5].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                  |                                                                                                                                                                                            |
|         bufferOrRendezvousSend(2): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                         |                                                                                                                                                                                            |
|           getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                       |                                                                                                                                                                                            |
|             bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                               |                                                                                                                                                                                            |
|           getReceiversCounter$kotlinx_coroutines_core(): 2 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                               |                                                                                                                                                                                            |
|             receivers.get(): 2 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                       |                                                                                                                                                                                            |
|         segment.casState$kotlinx_coroutines_core(2, null) (suspendable with <continuation>#9): true at BufferedChannel.updateCellSend(BufferedChannel.kt:448)                              |                                                                                                                                                                                            |
|           data[5].compareAndSet(null) (suspendable with <continuation>#9): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                |                                                                                                                                                                                            |
|       BufferedChannel.prepareSenderForSuspension(<continuation>#9, ChannelSegment#1, 2) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                                  |                                                                                                                                                                                            |
|         $this$prepareSenderForSuspension.invokeOnCancellation(ChannelSegment#1, 34) at BufferedChannel.prepareSenderForSuspension(BufferedChannel.kt:178)                                  |                                                                                                                                                                                            |
|           _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:0)                                                         |                                                                                                                                                                                            |
|           _decisionAndIndex.compareAndSet(536870911, 34): true at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                     |                                                                                                                                                                                            |
|           invokeOnCancellationImpl(ChannelSegment#1) at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:394)                                               |                                                                                                                                                                                            |
|             _state.get(): Active#1 at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                             |                                                                                                                                                                                            |
|             _state.compareAndSet(Active#1, ChannelSegment#1): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:407)                             |                                                                                                                                                                                            |
|       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                                    |                                                                                                                                                                                            |
|         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                   |                                                                                                                                                                                            |
|           resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                     |                                                                                                                                                                                            |
|         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                    |                                                                                                                                                                                            |
|           _decisionAndIndex.get(): 34 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                          |                                                                                                                                                                                            |
|           _decisionAndIndex.compareAndSet(34, 536870946): true at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                               |                                                                                                                                                                                            |
|         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                               |                                                                                                                                                                                            |
|           _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                                     |                                                                                                                                                                                            |
|         installParentHandle(): ChildContinuation#4 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                            |                                                                                                                                                                                            |
|           Job$DefaultImpls.invokeOnCompletion(true, true, ChildContinuation#4): ChildContinuation#4 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:348) |                                                                                                                                                                                            |
|             ChildContinuation#4.job = JobImpl#2 at JobNode.setJob(JobSupport.kt:1348)                                                                                                      |                                                                                                                                                                                            |
|           _parentHandle.compareAndSet(null, ChildContinuation#4): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                              |                                                                                                                                                                                            |
|         switch (reason: coroutine is suspended)                                                                                                                                            |                                                                                                                                                                                            |
|                                                                                                                                                                                            |   channel1.receive() (suspendable with <continuation>#1): 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:166)                         |
|                                                                                                                                                                                            |     receiveSegment.get(): ChannelSegment#1 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                |
|                                                                                                                                                                                            |     this_$iv.isClosedForReceive(): false at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                  |
|                                                                                                                                                                                            |       sendersAndCloseStatus.get(): 3 at BufferedChannel.isClosedForReceive(BufferedChannel.kt:2188)                                                                                        |
|                                                                                                                                                                                            |     receivers.getAndIncrement(): 2 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                        |
|                                                                                                                                                                                            |     BufferedChannel.updateCellReceive(ChannelSegment#1, 2, 2, null): 3 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                    |
|                                                                                                                                                                                            |       segment.getState$kotlinx_coroutines_core(2): <continuation>#9 at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                           |
|                                                                                                                                                                                            |         data[5].get(): <continuation>#9 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                        |
|                                                                                                                                                                                            |       updateCellReceiveSlow(ChannelSegment#1, 2, 2, null): 3 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1031)                                                                 |
|                                                                                                                                                                                            |         segment.getState$kotlinx_coroutines_core(2): <continuation>#9 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1048)                                                    |
|                                                                                                                                                                                            |           data[5].get(): <continuation>#9 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                      |
|                                                                                                                                                                                            |         segment.casState$kotlinx_coroutines_core(2, <continuation>#9, <S_RESUMING_BY_RCV>): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1115)                         |
|                                                                                                                                                                                            |           data[5].compareAndSet(<continuation>#9, <S_RESUMING_BY_RCV>): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                   |
|                                                                                                                                                                                            |         tryResumeSender(<continuation>#9, ChannelSegment#1, 2): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1120)                                                     |
|                                                                                                                                                                                            |           BufferedChannelKt.tryResume0(<continuation>#9, Unit, null): true at BufferedChannel.tryResumeSender(BufferedChannel.kt:1151)                                                     |
|                                                                                                                                                                                            |             $this$tryResume0.tryResume(Unit, null, null): <RESUME_TOKEN> at BufferedChannelKt.tryResume0(BufferedChannel.kt:2894)                                                          |
|                                                                                                                                                                                            |               tryResumeImpl(Unit, null, null): <RESUME_TOKEN> at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:582)                                                 |
|                                                                                                                                                                                            |                 _state.get(): ChannelSegment#1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:0)                                                              |
|                                                                                                                                                                                            |                 resumeMode ➜ 1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:540)                                                                            |
|                                                                                                                                                                                            |                 _state.compareAndSet(ChannelSegment#1, Unit): true at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:541)                                        |
|                                                                                                                                                                                            |                 detachChildIfNonResuable() at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:542)                                                                |
|                                                                                                                                                                                            |                   isReusable(): false at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                          |
|                                                                                                                                                                                            |                     resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                           |
|                                                                                                                                                                                            |                   detachChild$kotlinx_coroutines_core() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                        |
|                                                                                                                                                                                            |                     getParentHandle(): ChildContinuation#4 at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:572)                          |
|                                                                                                                                                                                            |                       _parentHandle.get(): ChildContinuation#4 at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                          |
|                                                                                                                                                                                            |                     handle.dispose() at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:573)                                                |
|                                                                                                                                                                                            |                       getJob(): JobImpl#2 at JobNode.dispose(JobSupport.kt:1351)                                                                                                           |
|                                                                                                                                                                                            |                         job ➜ JobImpl#2 at JobNode.getJob(JobSupport.kt:1348)                                                                                                              |
|                                                                                                                                                                                            |                     _parentHandle.set(NonDisposableHandle#1) at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:574)                        |
|                                                                                                                                                                                            |             $this$tryResume0.completeResume(<RESUME_TOKEN>) at BufferedChannelKt.tryResume0(BufferedChannel.kt:2896)                                                                       |
|                                                                                                                                                                                            |               resumeMode ➜ 1 at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                             |
|                                                                                                                                                                                            |               dispatchResume(1) at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                          |
|                                                                                                                                                                                            |                 tryResume(): false at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                       |
|                                                                                                                                                                                            |                   _decisionAndIndex.get(): 536870946 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                            |
|                                                                                                                                                                                            |                 DispatchedTaskKt.dispatch(<continuation>#9, 1) at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:474)                                           |
|                                                                                                                                                                                            |                   DispatchedTaskKt.resume(<continuation>#9, <continuation>#6, false) at DispatchedTaskKt.dispatch(DispatchedTask.kt:168)                                                   |
|                                                                                                                                                                                            |                     $this$resume.takeState$kotlinx_coroutines_core() at DispatchedTaskKt.resume(DispatchedTask.kt:174)                                                                     |
|                                                                                                                                                                                            |                       getState$kotlinx_coroutines_core() at CancellableContinuationImpl.takeState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:168)                              |
|                                                                                                                                                                                            |                         _state.get() at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                                   |
|                                                                                                                                                                                            |         segment.setState$kotlinx_coroutines_core(2, <DONE_RCV>) at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1128)                                                          |
|                                                                                                                                                                                            |           data[5].set(<DONE_RCV>) at ChannelSegment.setState$kotlinx_coroutines_core(BufferedChannel.kt:2776)                                                                              |
|                                                                                                                                                                                            |         expandBuffer() at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1129)                                                                                                   |
|                                                                                                                                                                                            |           isRendezvousOrUnlimited(): true at BufferedChannel.expandBuffer(BufferedChannel.kt:1173)                                                                                         |
|                                                                                                                                                                                            |             getBufferEndCounter(): 0 at BufferedChannel.isRendezvousOrUnlimited(BufferedChannel.kt:90)                                                                                     |
|                                                                                                                                                                                            |               bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                             |
|                                                                                                                                                                                            |         segment.retrieveElement$kotlinx_coroutines_core(2): 3 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1130)                                                            |
|                                                                                                                                                                                            |           getElement$kotlinx_coroutines_core(2): 3 at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                      |
|                                                                                                                                                                                            |             data[4].get(): 3 at ChannelSegment.getElement$kotlinx_coroutines_core(BufferedChannel.kt:2757)                                                                                 |
|                                                                                                                                                                                            |           cleanElement$kotlinx_coroutines_core(2) at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                       |
|                                                                                                                                                                                            |             setElementLazy(2, null) at ChannelSegment.cleanElement$kotlinx_coroutines_core(BufferedChannel.kt:2762)                                                                        |
|                                                                                                                                                                                            |               data[4].lazySet(null) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                              |
|                                                                                                                                                                                            |     segment$iv.cleanPrev() at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                                |
|                                                                                                                                                                                            |       _prev.lazySet(null) at ConcurrentLinkedListNode.cleanPrev(ConcurrentLinkedList.kt:132)                                                                                               |
|                                                                                                                                                                                            |   counter ➜ 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                                       |
|                                                                                                                                                                                            |   counter = 4 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:167)                                                                       |
|                                                                                                                                                                                            |   channel2.send(3) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:168)         |
|                                                                                                                                                                                            |     sendSegment.get(): ChannelSegment#2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                                      |
|                                                                                                                                                                                            |     sendersAndCloseStatus.getAndIncrement(): 2 at BufferedChannel.send(BufferedChannel.kt:0)                                                                                               |
|                                                                                                                                                                                            |     BufferedChannel.updateCellSend(ChannelSegment#2, 2, 3, 2, null, false): 3 at BufferedChannel.send(BufferedChannel.kt:0)                                                                |
|                                                                                                                                                                                            |       segment.storeElement$kotlinx_coroutines_core(2, 3) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                         |
|                                                                                                                                                                                            |         setElementLazy(2, 3) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                               |
|                                                                                                                                                                                            |           data[4].lazySet(3) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                     |
|                                                                                                                                                                                            |       segment.getState$kotlinx_coroutines_core(2): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                          |
|                                                                                                                                                                                            |         data[5].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                    |
|                                                                                                                                                                                            |       bufferOrRendezvousSend(2): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                           |
|                                                                                                                                                                                            |         getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                         |
|                                                                                                                                                                                            |           bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                                 |
|                                                                                                                                                                                            |         getReceiversCounter$kotlinx_coroutines_core(): 2 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                 |
|                                                                                                                                                                                            |           receivers.get(): 2 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                         |
|                                                                                                                                                                                            |     $this.sendOnNoWaiterSuspend(ChannelSegment#2, 2, 3, 2) (suspendable with <continuation>#1): COROUTINE_SUSPENDED at BufferedChannel.send(BufferedChannel.kt:0)                          |
|                                                                                                                                                                                            |       BufferedChannel.updateCellSend(ChannelSegment#2, 2, 3, 2, <continuation>#10, false): 2 at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3156)                             |
|                                                                                                                                                                                            |         segment.storeElement$kotlinx_coroutines_core(2, 3) at BufferedChannel.updateCellSend(BufferedChannel.kt:422)                                                                       |
|                                                                                                                                                                                            |           setElementLazy(2, 3) at ChannelSegment.storeElement$kotlinx_coroutines_core(BufferedChannel.kt:2753)                                                                             |
|                                                                                                                                                                                            |             data[4].lazySet(3) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                                   |
|                                                                                                                                                                                            |         segment.getState$kotlinx_coroutines_core(2): null at BufferedChannel.updateCellSend(BufferedChannel.kt:425)                                                                        |
|                                                                                                                                                                                            |           data[5].get(): null at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                                  |
|                                                                                                                                                                                            |         bufferOrRendezvousSend(2): false at BufferedChannel.updateCellSend(BufferedChannel.kt:432)                                                                                         |
|                                                                                                                                                                                            |           getBufferEndCounter(): 0 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                                                       |
|                                                                                                                                                                                            |             bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                               |
|                                                                                                                                                                                            |           getReceiversCounter$kotlinx_coroutines_core(): 2 at BufferedChannel.bufferOrRendezvousSend(BufferedChannel.kt:614)                                                               |
|                                                                                                                                                                                            |             receivers.get(): 2 at BufferedChannel.getReceiversCounter$kotlinx_coroutines_core(BufferedChannel.kt:71)                                                                       |
|                                                                                                                                                                                            |         segment.casState$kotlinx_coroutines_core(2, null) (suspendable with <continuation>#10): true at BufferedChannel.updateCellSend(BufferedChannel.kt:448)                             |
|                                                                                                                                                                                            |           data[5].compareAndSet(null) (suspendable with <continuation>#10): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                               |
|                                                                                                                                                                                            |       BufferedChannel.prepareSenderForSuspension(<continuation>#10, ChannelSegment#2, 2) at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3165)                                 |
|                                                                                                                                                                                            |         $this$prepareSenderForSuspension.invokeOnCancellation(ChannelSegment#2, 34) at BufferedChannel.prepareSenderForSuspension(BufferedChannel.kt:178)                                  |
|                                                                                                                                                                                            |           _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:0)                                                         |
|                                                                                                                                                                                            |           _decisionAndIndex.compareAndSet(536870911, 34): true at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                     |
|                                                                                                                                                                                            |           invokeOnCancellationImpl(ChannelSegment#2) at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:394)                                               |
|                                                                                                                                                                                            |             _state.get(): Active#1 at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                             |
|                                                                                                                                                                                            |             _state.compareAndSet(Active#1, ChannelSegment#2): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:407)                             |
|                                                                                                                                                                                            |       cancellable$iv.getResult(): COROUTINE_SUSPENDED at BufferedChannel.sendOnNoWaiterSuspend(BufferedChannel.kt:3259)                                                                    |
|                                                                                                                                                                                            |         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                   |
|                                                                                                                                                                                            |           resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                     |
|                                                                                                                                                                                            |         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                    |
|                                                                                                                                                                                            |           _decisionAndIndex.get(): 34 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                          |
|                                                                                                                                                                                            |           _decisionAndIndex.compareAndSet(34, 536870946): true at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                               |
|                                                                                                                                                                                            |         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                               |
|                                                                                                                                                                                            |           _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                                     |
|                                                                                                                                                                                            |         installParentHandle(): ChildContinuation#5 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                            |
|                                                                                                                                                                                            |           Job$DefaultImpls.invokeOnCompletion(true, true, ChildContinuation#5): ChildContinuation#5 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:348) |
|                                                                                                                                                                                            |             ChildContinuation#5.job = JobImpl#1 at JobNode.setJob(JobSupport.kt:1348)                                                                                                      |
|                                                                                                                                                                                            |           _parentHandle.compareAndSet(null, ChildContinuation#5): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                              |
|                                                                                                                                                                                            |         switch (reason: coroutine is suspended)                                                                                                                                            |
|   counter ➜ 4 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                                       |                                                                                                                                                                                            |
|   counter = 5 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:157)                                                                       |                                                                                                                                                                                            |
|   channel2.receive() (suspendable with <continuation>#4): 3 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:158)                         |                                                                                                                                                                                            |
|     receiveSegment.get(): ChannelSegment#2 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                |                                                                                                                                                                                            |
|     this_$iv.isClosedForReceive(): false at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                  |                                                                                                                                                                                            |
|       sendersAndCloseStatus.get(): 3 at BufferedChannel.isClosedForReceive(BufferedChannel.kt:2188)                                                                                        |                                                                                                                                                                                            |
|     receivers.getAndIncrement(): 2 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                        |                                                                                                                                                                                            |
|     BufferedChannel.updateCellReceive(ChannelSegment#2, 2, 2, null): 3 at BufferedChannel.receive(BufferedChannel.kt:0)                                                                    |                                                                                                                                                                                            |
|       segment.getState$kotlinx_coroutines_core(2): <continuation>#10 at BufferedChannel.updateCellReceive(BufferedChannel.kt:999)                                                          |                                                                                                                                                                                            |
|         data[5].get(): <continuation>#10 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                       |                                                                                                                                                                                            |
|       updateCellReceiveSlow(ChannelSegment#2, 2, 2, null): 3 at BufferedChannel.updateCellReceive(BufferedChannel.kt:1031)                                                                 |                                                                                                                                                                                            |
|         segment.getState$kotlinx_coroutines_core(2): <continuation>#10 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1048)                                                   |                                                                                                                                                                                            |
|           data[5].get(): <continuation>#10 at ChannelSegment.getState$kotlinx_coroutines_core(BufferedChannel.kt:2773)                                                                     |                                                                                                                                                                                            |
|         segment.casState$kotlinx_coroutines_core(2, <continuation>#10, <S_RESUMING_BY_RCV>): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1115)                        |                                                                                                                                                                                            |
|           data[5].compareAndSet(<continuation>#10, <S_RESUMING_BY_RCV>): true at ChannelSegment.casState$kotlinx_coroutines_core(BufferedChannel.kt:2779)                                  |                                                                                                                                                                                            |
|         tryResumeSender(<continuation>#10, ChannelSegment#2, 2): true at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1120)                                                    |                                                                                                                                                                                            |
|           BufferedChannelKt.tryResume0(<continuation>#10, Unit, null): true at BufferedChannel.tryResumeSender(BufferedChannel.kt:1151)                                                    |                                                                                                                                                                                            |
|             $this$tryResume0.tryResume(Unit, null, null): <RESUME_TOKEN> at BufferedChannelKt.tryResume0(BufferedChannel.kt:2894)                                                          |                                                                                                                                                                                            |
|               tryResumeImpl(Unit, null, null): <RESUME_TOKEN> at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:582)                                                 |                                                                                                                                                                                            |
|                 _state.get(): ChannelSegment#2 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:0)                                                              |                                                                                                                                                                                            |
|                 resumeMode ➜ 1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:540)                                                                            |                                                                                                                                                                                            |
|                 _state.compareAndSet(ChannelSegment#2, Unit): true at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:541)                                        |                                                                                                                                                                                            |
|                 detachChildIfNonResuable() at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:542)                                                                |                                                                                                                                                                                            |
|                   isReusable(): false at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                          |                                                                                                                                                                                            |
|                     resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                           |                                                                                                                                                                                            |
|                   detachChild$kotlinx_coroutines_core() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                        |                                                                                                                                                                                            |
|                     getParentHandle(): ChildContinuation#5 at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:572)                          |                                                                                                                                                                                            |
|                       _parentHandle.get(): ChildContinuation#5 at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                          |                                                                                                                                                                                            |
|                     handle.dispose() at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:573)                                                |                                                                                                                                                                                            |
|                       getJob(): JobImpl#1 at JobNode.dispose(JobSupport.kt:1351)                                                                                                           |                                                                                                                                                                                            |
|                         job ➜ JobImpl#1 at JobNode.getJob(JobSupport.kt:1348)                                                                                                              |                                                                                                                                                                                            |
|                     _parentHandle.set(NonDisposableHandle#1) at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:574)                        |                                                                                                                                                                                            |
|             $this$tryResume0.completeResume(<RESUME_TOKEN>) at BufferedChannelKt.tryResume0(BufferedChannel.kt:2896)                                                                       |                                                                                                                                                                                            |
|               resumeMode ➜ 1 at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                             |                                                                                                                                                                                            |
|               dispatchResume(1) at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                          |                                                                                                                                                                                            |
|                 tryResume(): false at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                       |                                                                                                                                                                                            |
|                   _decisionAndIndex.get(): 536870946 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                            |                                                                                                                                                                                            |
|                 DispatchedTaskKt.dispatch(<continuation>#10, 1) at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:474)                                          |                                                                                                                                                                                            |
|                   DispatchedTaskKt.resume(<continuation>#10, <continuation>#2, false) at DispatchedTaskKt.dispatch(DispatchedTask.kt:168)                                                  |                                                                                                                                                                                            |
|                     $this$resume.takeState$kotlinx_coroutines_core() at DispatchedTaskKt.resume(DispatchedTask.kt:174)                                                                     |                                                                                                                                                                                            |
|                       getState$kotlinx_coroutines_core() at CancellableContinuationImpl.takeState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:168)                              |                                                                                                                                                                                            |
|                         _state.get() at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                                   |                                                                                                                                                                                            |
|         segment.setState$kotlinx_coroutines_core(2, <DONE_RCV>) at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1128)                                                          |                                                                                                                                                                                            |
|           data[5].set(<DONE_RCV>) at ChannelSegment.setState$kotlinx_coroutines_core(BufferedChannel.kt:2776)                                                                              |                                                                                                                                                                                            |
|         expandBuffer() at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1129)                                                                                                   |                                                                                                                                                                                            |
|           isRendezvousOrUnlimited(): true at BufferedChannel.expandBuffer(BufferedChannel.kt:1173)                                                                                         |                                                                                                                                                                                            |
|             getBufferEndCounter(): 0 at BufferedChannel.isRendezvousOrUnlimited(BufferedChannel.kt:90)                                                                                     |                                                                                                                                                                                            |
|               bufferEnd.get(): 0 at BufferedChannel.getBufferEndCounter(BufferedChannel.kt:72)                                                                                             |                                                                                                                                                                                            |
|         segment.retrieveElement$kotlinx_coroutines_core(2): 3 at BufferedChannel.updateCellReceiveSlow(BufferedChannel.kt:1130)                                                            |                                                                                                                                                                                            |
|           getElement$kotlinx_coroutines_core(2): 3 at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                      |                                                                                                                                                                                            |
|             data[4].get(): 3 at ChannelSegment.getElement$kotlinx_coroutines_core(BufferedChannel.kt:2757)                                                                                 |                                                                                                                                                                                            |
|           cleanElement$kotlinx_coroutines_core(2) at ChannelSegment.retrieveElement$kotlinx_coroutines_core(BufferedChannel.kt:2759)                                                       |                                                                                                                                                                                            |
|             setElementLazy(2, null) at ChannelSegment.cleanElement$kotlinx_coroutines_core(BufferedChannel.kt:2762)                                                                        |                                                                                                                                                                                            |
|               data[4].lazySet(null) at ChannelSegment.setElementLazy(BufferedChannel.kt:2766)                                                                                              |                                                                                                                                                                                            |
|     segment$iv.cleanPrev() at BufferedChannel.receive(BufferedChannel.kt:0)                                                                                                                |                                                                                                                                                                                            |
|       _prev.lazySet(null) at ConcurrentLinkedListNode.cleanPrev(ConcurrentLinkedList.kt:132)                                                                                               |                                                                                                                                                                                            |
|   counter ➜ 5 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation1(MultipleSuspensionsTests.kt:160)                                                                       |                                                                                                                                                                                            |
|   result: IllegalStateException #1                                                                                                                                                         |                                                                                                                                                                                            |
|                                                                                                                                                                                            |   counter ➜ 5 at MultipleSuspensionPointsChannelsTraceRepresentationTest.operation2(MultipleSuspensionsTests.kt:170)                                                                       |
|                                                                                                                                                                                            |   result: IllegalStateException #2                                                                                                                                                         |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
