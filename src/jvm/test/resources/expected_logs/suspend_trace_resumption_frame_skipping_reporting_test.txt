= Invalid execution results =
| ----------------------- |
|  Thread 1   | Thread 2  |
| ----------------------- |
| foo(): void | bar(): -1 |
| ----------------------- |

The following interleaving leads to the error:
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                     Thread 1                                                                     |                                                           Thread 2                                                            |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                                  | bar(): -1                                                                                                                     |
|                                                                                                                                                  |   barStarted.WRITE(true) at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:139)            |
|                                                                                                                                                  |   switch                                                                                                                      |
| foo()                                                                                                                                            |                                                                                                                               |
|   barStarted.READ: true at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:132)                                |                                                                                                                               |
|   canEnterForbiddenBlock.WRITE(true) at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:132)                   |                                                                                                                               |
|   function1(): Unit#1 at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:133)                                  |                                                                                                                               |
|     counter.READ: 0 at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:148)                              |                                                                                                                               |
|     counter.WRITE(1) at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:148)                             |                                                                                                                               |
|     function2(): COROUTINE_SUSPENDED at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:149)             |                                                                                                                               |
|       counter.READ: 1 at SuspendTraceResumptionFrameSkippingReportingTest.function2(SuspendTraceReportingTest.kt:154)                            |                                                                                                                               |
|       counter.WRITE(2) at SuspendTraceResumptionFrameSkippingReportingTest.function2(SuspendTraceReportingTest.kt:154)                           |                                                                                                                               |
|       function3(): COROUTINE_SUSPENDED at SuspendTraceResumptionFrameSkippingReportingTest.function2(SuspendTraceReportingTest.kt:155)           |                                                                                                                               |
|         counter.READ: 2 at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:159)                          |                                                                                                                               |
|         counter.WRITE(3) at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:159)                         |                                                                                                                               |
|         continuation.WRITE(<cont>) at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:161)               |                                                                                                                               |
|         <cont>.getOrThrow(): COROUTINE_SUSPENDED at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:160) |                                                                                                                               |
|           result.READ: UNDECIDED at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:51)                                                       |                                                                                                                               |
|           result.compareAndSet(UNDECIDED,COROUTINE_SUSPENDED): true at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:53)                    |                                                                                                                               |
|   switch (reason: coroutine is suspended)                                                                                                        |                                                                                                                               |
|                                                                                                                                                  |   continuation.READ: <cont> at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:140)         |
|                                                                                                                                                  |   continuation.READ: <cont> at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:141)         |
|                                                                                                                                                  |   <cont>.resumeWith(Unit#1) at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:141)         |
|                                                                                                                                                  |   canEnterForbiddenBlock.READ: true at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:142) |
|                                                                                                                                                  |   result: -1                                                                                                                  |
|     counter.READ: 3 at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:150)                              |                                                                                                                               |
|     counter.WRITE(4) at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:150)                             |                                                                                                                               |
|   canEnterForbiddenBlock.WRITE(false) at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:134)                  |                                                                                                                               |
|   result: void                                                                                                                                   |                                                                                                                               |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

Detailed trace:
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                     Thread 1                                                                     |                                                           Thread 2                                                            |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                                  | bar(): -1                                                                                                                     |
|                                                                                                                                                  |   barStarted.WRITE(true) at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:139)            |
|                                                                                                                                                  |   switch                                                                                                                      |
| foo()                                                                                                                                            |                                                                                                                               |
|   barStarted.READ: true at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:132)                                |                                                                                                                               |
|   canEnterForbiddenBlock.WRITE(true) at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:132)                   |                                                                                                                               |
|   function1(): Unit#1 at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:133)                                  |                                                                                                                               |
|     counter.READ: 0 at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:148)                              |                                                                                                                               |
|     counter.WRITE(1) at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:148)                             |                                                                                                                               |
|     function2(): COROUTINE_SUSPENDED at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:149)             |                                                                                                                               |
|       counter.READ: 1 at SuspendTraceResumptionFrameSkippingReportingTest.function2(SuspendTraceReportingTest.kt:154)                            |                                                                                                                               |
|       counter.WRITE(2) at SuspendTraceResumptionFrameSkippingReportingTest.function2(SuspendTraceReportingTest.kt:154)                           |                                                                                                                               |
|       function3(): COROUTINE_SUSPENDED at SuspendTraceResumptionFrameSkippingReportingTest.function2(SuspendTraceReportingTest.kt:155)           |                                                                                                                               |
|         counter.READ: 2 at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:159)                          |                                                                                                                               |
|         counter.WRITE(3) at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:159)                         |                                                                                                                               |
|         continuation.WRITE(<cont>) at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:161)               |                                                                                                                               |
|         <cont>.getOrThrow(): COROUTINE_SUSPENDED at SuspendTraceResumptionFrameSkippingReportingTest.function3(SuspendTraceReportingTest.kt:160) |                                                                                                                               |
|           result.READ: UNDECIDED at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:51)                                                       |                                                                                                                               |
|           result.compareAndSet(UNDECIDED,COROUTINE_SUSPENDED): true at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:53)                    |                                                                                                                               |
|   switch (reason: coroutine is suspended)                                                                                                        |                                                                                                                               |
|                                                                                                                                                  |   continuation.READ: <cont> at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:140)         |
|                                                                                                                                                  |   continuation.READ: <cont> at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:141)         |
|                                                                                                                                                  |   <cont>.resumeWith(Unit#1) at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:141)         |
|                                                                                                                                                  |     result.READ: COROUTINE_SUSPENDED at SafeContinuation.resumeWith(SafeContinuationJvm.kt:37)                                |
|                                                                                                                                                  |     result.compareAndSet(COROUTINE_SUSPENDED,RESUMED): true at SafeContinuation.resumeWith(SafeContinuationJvm.kt:40)         |
|                                                                                                                                                  |   canEnterForbiddenBlock.READ: true at SuspendTraceResumptionFrameSkippingReportingTest.bar(SuspendTraceReportingTest.kt:142) |
|                                                                                                                                                  |   result: -1                                                                                                                  |
|     counter.READ: 3 at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:150)                              |                                                                                                                               |
|     counter.WRITE(4) at SuspendTraceResumptionFrameSkippingReportingTest.function1(SuspendTraceReportingTest.kt:150)                             |                                                                                                                               |
|   canEnterForbiddenBlock.WRITE(false) at SuspendTraceResumptionFrameSkippingReportingTest.foo(SuspendTraceReportingTest.kt:134)                  |                                                                                                                               |
|   result: void                                                                                                                                   |                                                                                                                               |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
