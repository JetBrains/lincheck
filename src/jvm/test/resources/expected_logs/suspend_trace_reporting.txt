= Invalid execution results =
| ----------------------- |
|  Thread 1   | Thread 2  |
| ----------------------- |
| foo(): void | bar(): -1 |
| ----------------------- |

The following interleaving leads to the error:
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                        Thread 1                                                                                                         |                                                      Thread 2                                                      |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                                                                                                         | bar(): -1                                                                                                          |
|                                                                                                                                                                                                                         |   ResultKt.throwOnFailure(null) at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:36)                  |
|                                                                                                                                                                                                                         |   barStarted = true at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:38)                              |
|                                                                                                                                                                                                                         |   lock.lock(null) [suspendable: Continuation#1] at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:194) |
|                                                                                                                                                                                                                         |   counter ➜ 0 at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:40)                                    |
|                                                                                                                                                                                                                         |   counter = 1 at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:40)                                    |
|                                                                                                                                                                                                                         |   lock.unlock(null) at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:198)                             |
|                                                                                                                                                                                                                         |     isLocked(): true at MutexImpl.unlock(Mutex.kt:213)                                                             |
|                                                                                                                                                                                                                         |     owner.get(): null at MutexImpl.unlock(Mutex.kt:215)                                                            |
|                                                                                                                                                                                                                         |     MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl.unlock(Mutex.kt:216)                                   |
|                                                                                                                                                                                                                         |     MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl.unlock(Mutex.kt:220)                                   |
|                                                                                                                                                                                                                         |     switch                                                                                                         |
| foo()                                                                                                                                                                                                                   |                                                                                                                    |
|   ResultKt.throwOnFailure(null) at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:27)                                                                                                                       |                                                                                                                    |
|   barStarted ➜ true at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:29)                                                                                                                                   |                                                                                                                    |
|   canEnterForbiddenBlock = true at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:29)                                                                                                                       |                                                                                                                    |
|   lock.lock(null) [suspendable: Continuation#2]: COROUTINE_SUSPENDED at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:184)                                                                                 |                                                                                                                    |
|     $this.tryLock(null): false at MutexImpl.lock(Mutex.kt:0)                                                                                                                                                            |                                                                                                                    |
|     $this.lockSuspend(null) [suspendable: Continuation#2]: COROUTINE_SUSPENDED at MutexImpl.lock(Mutex.kt:0)                                                                                                            |                                                                                                                    |
|       CancellableContinuationKt.getOrCreateCancellableContinuation(Continuation#3): Continuation#4 at MutexImpl.lockSuspend(Mutex.kt:312)                                                                               |                                                                                                                    |
|       acquire() [suspendable: Continuation#5] at MutexImpl.lockSuspend(Mutex.kt:177)                                                                                                                                    |                                                                                                                    |
|       cancellable$iv.getResult(): COROUTINE_SUSPENDED at MutexImpl.lockSuspend(Mutex.kt:321)                                                                                                                            |                                                                                                                    |
|         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                                                |                                                                                                                    |
|         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                                                 |                                                                                                                    |
|         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                                                            |                                                                                                                    |
|         installParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                                                         |                                                                                                                    |
|           getContext(): CombinedContext#1 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:346)                                                                                        |                                                                                                                    |
|           context.get(Key#1): JobImpl#1 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:346)                                                                                          |                                                                                                                    |
|           getAsHandler() at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:350)                                                                                                         |                                                                                                                    |
|           Job$DefaultImpls.invokeOnCompletion$default(JobImpl#1, true, false, ChildContinuation#1, 2, null): ChildContinuation#1 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:348) |                                                                                                                    |
|           switch                                                                                                                                                                                                        |                                                                                                                    |
|                                                                                                                                                                                                                         |     owner.compareAndSet(null, <NO_OWNER>): true at MutexImpl.unlock(Mutex.kt:220)                                  |
|                                                                                                                                                                                                                         |     release() at MutexImpl.unlock(Mutex.kt:222)                                                                    |
|                                                                                                                                                                                                                         |   canEnterForbiddenBlock ➜ true at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:42)                  |
|                                                                                                                                                                                                                         |   Boxing.boxInt(-1): -1 at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:42)                          |
|                                                                                                                                                                                                                         |   result: -1                                                                                                       |
|           _parentHandle.compareAndSet(null, ChildContinuation#1): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                                                           |                                                                                                                    |
|       DebugProbesKt.probeCoroutineSuspended(Continuation#2) at MutexImpl.lockSuspend(Mutex.kt:311)                                                                                                                      |                                                                                                                    |
|   ResultKt.throwOnFailure(Unit) at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:27)                                                                                                                       |                                                                                                                    |
|   counter ➜ 1 at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:31)                                                                                                                                         |                                                                                                                    |
|   counter = 2 at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:31)                                                                                                                                         |                                                                                                                    |
|   lock.unlock(null) at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:188)                                                                                                                                  |                                                                                                                    |
|   canEnterForbiddenBlock = false at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:33)                                                                                                                      |                                                                                                                    |
|   result: void                                                                                                                                                                                                          |                                                                                                                    |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

Detailed trace:
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                        Thread 1                                                                                                         |                                                                                       Thread 2                                                                                       |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                                                                                                         | bar(): -1                                                                                                                                                                            |
|                                                                                                                                                                                                                         |   ResultKt.throwOnFailure(null) at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:36)                                                                                    |
|                                                                                                                                                                                                                         |   barStarted = true at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:38)                                                                                                |
|                                                                                                                                                                                                                         |   lock.lock(null) [suspendable: Continuation#1] at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:194)                                                                   |
|                                                                                                                                                                                                                         |     $this.tryLock(null): true at MutexImpl.lock(Mutex.kt:0)                                                                                                                          |
|                                                                                                                                                                                                                         |       tryLockImpl(null): 0 at MutexImpl.tryLock(Mutex.kt:183)                                                                                                                        |
|                                                                                                                                                                                                                         |         tryAcquire(): true at MutexImpl.tryLockImpl(Mutex.kt:189)                                                                                                                    |
|                                                                                                                                                                                                                         |           _availablePermits.get(): 1 at SemaphoreImpl.tryAcquire(Semaphore.kt:159)                                                                                                   |
|                                                                                                                                                                                                                         |           _availablePermits.compareAndSet(1, 0): true at SemaphoreImpl.tryAcquire(Semaphore.kt:171)                                                                                  |
|                                                                                                                                                                                                                         |         DebugKt.getASSERTIONS_ENABLED(): true at MutexImpl.tryLockImpl(Mutex.kt:190)                                                                                                 |
|                                                                                                                                                                                                                         |         owner.get(): <NO_OWNER> at MutexImpl.tryLockImpl(Mutex.kt:190)                                                                                                               |
|                                                                                                                                                                                                                         |         MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl.tryLockImpl(Mutex.kt:190)                                                                                            |
|                                                                                                                                                                                                                         |         owner.set(null) at MutexImpl.tryLockImpl(Mutex.kt:191)                                                                                                                       |
|                                                                                                                                                                                                                         |   counter ➜ 0 at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:40)                                                                                                      |
|                                                                                                                                                                                                                         |   counter = 1 at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:40)                                                                                                      |
|                                                                                                                                                                                                                         |   lock.unlock(null) at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:198)                                                                                               |
|                                                                                                                                                                                                                         |     isLocked(): true at MutexImpl.unlock(Mutex.kt:213)                                                                                                                               |
|                                                                                                                                                                                                                         |       getAvailablePermits(): 0 at MutexImpl.isLocked(Mutex.kt:149)                                                                                                                   |
|                                                                                                                                                                                                                         |         _availablePermits.get(): 0 at SemaphoreImpl.getAvailablePermits(Semaphore.kt:152)                                                                                            |
|                                                                                                                                                                                                                         |         Math.max(0, 0): 0 at SemaphoreImpl.getAvailablePermits(Semaphore.kt:152)                                                                                                     |
|                                                                                                                                                                                                                         |     owner.get(): null at MutexImpl.unlock(Mutex.kt:215)                                                                                                                              |
|                                                                                                                                                                                                                         |     MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl.unlock(Mutex.kt:216)                                                                                                     |
|                                                                                                                                                                                                                         |     MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl.unlock(Mutex.kt:220)                                                                                                     |
|                                                                                                                                                                                                                         |     switch                                                                                                                                                                           |
| foo()                                                                                                                                                                                                                   |                                                                                                                                                                                      |
|   ResultKt.throwOnFailure(null) at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:27)                                                                                                                       |                                                                                                                                                                                      |
|   barStarted ➜ true at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:29)                                                                                                                                   |                                                                                                                                                                                      |
|   canEnterForbiddenBlock = true at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:29)                                                                                                                       |                                                                                                                                                                                      |
|   lock.lock(null) [suspendable: Continuation#2]: COROUTINE_SUSPENDED at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:184)                                                                                 |                                                                                                                                                                                      |
|     $this.tryLock(null): false at MutexImpl.lock(Mutex.kt:0)                                                                                                                                                            |                                                                                                                                                                                      |
|       tryLockImpl(null): 1 at MutexImpl.tryLock(Mutex.kt:183)                                                                                                                                                           |                                                                                                                                                                                      |
|         tryAcquire(): false at MutexImpl.tryLockImpl(Mutex.kt:189)                                                                                                                                                      |                                                                                                                                                                                      |
|           _availablePermits.get(): 0 at SemaphoreImpl.tryAcquire(Semaphore.kt:159)                                                                                                                                      |                                                                                                                                                                                      |
|     $this.lockSuspend(null) [suspendable: Continuation#2]: COROUTINE_SUSPENDED at MutexImpl.lock(Mutex.kt:0)                                                                                                            |                                                                                                                                                                                      |
|       CancellableContinuationKt.getOrCreateCancellableContinuation(Continuation#3): Continuation#4 at MutexImpl.lockSuspend(Mutex.kt:312)                                                                               |                                                                                                                                                                                      |
|       acquire() [suspendable: Continuation#5] at MutexImpl.lockSuspend(Mutex.kt:177)                                                                                                                                    |                                                                                                                                                                                      |
|         decPermits(): 0 at SemaphoreImpl.acquire(Semaphore.kt:413)                                                                                                                                                      |                                                                                                                                                                                      |
|           _availablePermits.getAndDecrement(): 0 at SemaphoreImpl.decPermits(Semaphore.kt:237)                                                                                                                          |                                                                                                                                                                                      |
|         addAcquireToQueue(Continuation#5): true at SemaphoreImpl.acquire(Semaphore.kt:199)                                                                                                                              |                                                                                                                                                                                      |
|           tail.get(): SemaphoreSegment#1 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:286)                                                                                                                           |                                                                                                                                                                                      |
|           enqIdx.getAndIncrement(): 0 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:287)                                                                                                                              |                                                                                                                                                                                      |
|           SemaphoreKt.access$getSEGMENT_SIZE$p(): 16 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:289)                                                                                                               |                                                                                                                                                                                      |
|           ConcurrentLinkedListKt.findSegmentInternal(SemaphoreSegment#1, 0, createNewSegment$1): SemaphoreSegment#1 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:432)                                                |                                                                                                                                                                                      |
|             cur.isRemoved(): false at ConcurrentLinkedListKt.findSegmentInternal(ConcurrentLinkedList.kt:26)                                                                                                            |                                                                                                                                                                                      |
|               cleanedAndPointers.get(): 131072 at Segment.isRemoved(ConcurrentLinkedList.kt:222)                                                                                                                        |                                                                                                                                                                                      |
|               getNumberOfSlots(): 16 at Segment.isRemoved(ConcurrentLinkedList.kt:222)                                                                                                                                  |                                                                                                                                                                                      |
|                 SemaphoreKt.access$getSEGMENT_SIZE$p(): 16 at SemaphoreSegment.getNumberOfSlots(Semaphore.kt:364)                                                                                                       |                                                                                                                                                                                      |
|             SegmentOrClosed.constructor-impl(SemaphoreSegment#1): SemaphoreSegment#1 at ConcurrentLinkedListKt.findSegmentInternal(ConcurrentLinkedList.kt:38)                                                          |                                                                                                                                                                                      |
|           SegmentOrClosed.isClosed-impl(SemaphoreSegment#1): false at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:433)                                                                                                 |                                                                                                                                                                                      |
|             ConcurrentLinkedListKt.access$getCLOSED$p(): <CLOSED> at SegmentOrClosed.isClosed-impl(ConcurrentLinkedList.kt:261)                                                                                         |                                                                                                                                                                                      |
|           SegmentOrClosed.getSegment-impl(SemaphoreSegment#1): SemaphoreSegment#1 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:433)                                                                                  |                                                                                                                                                                                      |
|             ConcurrentLinkedListKt.access$getCLOSED$p(): <CLOSED> at SegmentOrClosed.getSegment-impl(ConcurrentLinkedList.kt:263)                                                                                       |                                                                                                                                                                                      |
|           tail.get(): SemaphoreSegment#1 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:433)                                                                                                                           |                                                                                                                                                                                      |
|           SegmentOrClosed.getSegment-impl(SemaphoreSegment#1): SemaphoreSegment#1 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:290)                                                                                  |                                                                                                                                                                                      |
|             ConcurrentLinkedListKt.access$getCLOSED$p(): <CLOSED> at SegmentOrClosed.getSegment-impl(ConcurrentLinkedList.kt:263)                                                                                       |                                                                                                                                                                                      |
|           SemaphoreKt.access$getSEGMENT_SIZE$p(): 16 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:291)                                                                                                               |                                                                                                                                                                                      |
|           segment.cas() at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:293)                                                                                                                                            |                                                                                                                                                                                      |
|             getAcquirers(): AtomicReferenceArray#1 at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:442)                                                                                                                 |                                                                                                                                                                                      |
|             acquirers[0].compareAndSet(null, Continuation#5): true at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:442)                                                                                                 |                                                                                                                                                                                      |
|           waiter.invokeOnCancellation(SemaphoreSegment#1, 0) at SemaphoreImpl.addAcquireToQueue(Semaphore.kt:294)                                                                                                       |                                                                                                                                                                                      |
|             cont.invokeOnCancellation(SemaphoreSegment#1, 0) at MutexImpl$CancellableContinuationWithOwner.invokeOnCancellation(Mutex.kt:0)                                                                             |                                                                                                                                                                                      |
|               _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:0)                                                                                  |                                                                                                                                                                                      |
|               getIndex() at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:389)                                                                                                        |                                                                                                                                                                                      |
|               getDecision() at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                                                                                     |                                                                                                                                                                                      |
|               decisionAndIndex() at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                                                                                |                                                                                                                                                                                      |
|               _decisionAndIndex.compareAndSet(536870911, 0): true at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:392)                                                               |                                                                                                                                                                                      |
|               invokeOnCancellationImpl(SemaphoreSegment#1) at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:394)                                                                      |                                                                                                                                                                                      |
|                 DebugKt.getASSERTIONS_ENABLED(): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                                       |                                                                                                                                                                                      |
|                 _state.get(): Active#1 at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                                                      |                                                                                                                                                                                      |
|                 _state.compareAndSet(Active#1, SemaphoreSegment#1): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:407)                                                    |                                                                                                                                                                                      |
|       cancellable$iv.getResult(): COROUTINE_SUSPENDED at MutexImpl.lockSuspend(Mutex.kt:321)                                                                                                                            |                                                                                                                                                                                      |
|         isReusable(): false at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:297)                                                                                                                |                                                                                                                                                                                      |
|           resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                                                  |                                                                                                                                                                                      |
|           DispatchedTaskKt.isReusableMode(1): false at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                                       |                                                                                                                                                                                      |
|         trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                                                 |                                                                                                                                                                                      |
|           _decisionAndIndex.get(): 0 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                                                        |                                                                                                                                                                                      |
|           getDecision() at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:277)                                                                                                                   |                                                                                                                                                                                      |
|           getIndex() at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                                                                                                      |                                                                                                                                                                                      |
|           decisionAndIndex() at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                                                                                              |                                                                                                                                                                                      |
|           _decisionAndIndex.compareAndSet(0, 536870912): true at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                                                             |                                                                                                                                                                                      |
|         getParentHandle(): null at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                                                            |                                                                                                                                                                                      |
|           _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                                                                  |                                                                                                                                                                                      |
|         installParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:311)                                                                                         |                                                                                                                                                                                      |
|           getContext(): CombinedContext#1 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:346)                                                                                        |                                                                                                                                                                                      |
|           context.get(Key#1): JobImpl#1 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:346)                                                                                          |                                                                                                                                                                                      |
|             CoroutineContext$Element$DefaultImpls.get(JobImpl#1, Key#1): JobImpl#1 at Job$DefaultImpls.get(Job.kt:112)                                                                                                  |                                                                                                                                                                                      |
|               $this.getKey(): Key#1 at CoroutineContext$Element$DefaultImpls.get(CoroutineContext.kt:67)                                                                                                                |                                                                                                                                                                                      |
|           getAsHandler() at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:350)                                                                                                         |                                                                                                                                                                                      |
|           Job$DefaultImpls.invokeOnCompletion$default(JobImpl#1, true, false, ChildContinuation#1, 2, null): ChildContinuation#1 at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:348) |                                                                                                                                                                                      |
|             JobImpl#1.invokeOnCompletion(true, true, ChildContinuation#1): ChildContinuation#1 at Job$DefaultImpls.invokeOnCompletion$default(Job.kt:357)                                                               |                                                                                                                                                                                      |
|           switch                                                                                                                                                                                                        |                                                                                                                                                                                      |
|                                                                                                                                                                                                                         |     owner.compareAndSet(null, <NO_OWNER>): true at MutexImpl.unlock(Mutex.kt:220)                                                                                                    |
|                                                                                                                                                                                                                         |     release() at MutexImpl.unlock(Mutex.kt:222)                                                                                                                                      |
|                                                                                                                                                                                                                         |       _availablePermits.getAndIncrement(): -1 at SemaphoreImpl.release(Semaphore.kt:250)                                                                                             |
|                                                                                                                                                                                                                         |       tryResumeNextFromQueue(): true at SemaphoreImpl.release(Semaphore.kt:265)                                                                                                      |
|                                                                                                                                                                                                                         |         head.get(): SemaphoreSegment#1 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:319)                                                                                     |
|                                                                                                                                                                                                                         |         deqIdx.getAndIncrement(): 0 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:320)                                                                                        |
|                                                                                                                                                                                                                         |         SemaphoreKt.access$getSEGMENT_SIZE$p(): 16 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:321)                                                                         |
|                                                                                                                                                                                                                         |         ConcurrentLinkedListKt.findSegmentInternal(SemaphoreSegment#1, 0, createNewSegment$1): SemaphoreSegment#1 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:446)          |
|                                                                                                                                                                                                                         |           cur.isRemoved(): false at ConcurrentLinkedListKt.findSegmentInternal(ConcurrentLinkedList.kt:26)                                                                           |
|                                                                                                                                                                                                                         |             cleanedAndPointers.get(): 131072 at Segment.isRemoved(ConcurrentLinkedList.kt:222)                                                                                       |
|                                                                                                                                                                                                                         |             getNumberOfSlots(): 16 at Segment.isRemoved(ConcurrentLinkedList.kt:222)                                                                                                 |
|                                                                                                                                                                                                                         |               SemaphoreKt.access$getSEGMENT_SIZE$p(): 16 at SemaphoreSegment.getNumberOfSlots(Semaphore.kt:364)                                                                      |
|                                                                                                                                                                                                                         |           SegmentOrClosed.constructor-impl(SemaphoreSegment#1): SemaphoreSegment#1 at ConcurrentLinkedListKt.findSegmentInternal(ConcurrentLinkedList.kt:38)                         |
|                                                                                                                                                                                                                         |         SegmentOrClosed.isClosed-impl(SemaphoreSegment#1): false at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:447)                                                           |
|                                                                                                                                                                                                                         |           ConcurrentLinkedListKt.access$getCLOSED$p(): <CLOSED> at SegmentOrClosed.isClosed-impl(ConcurrentLinkedList.kt:261)                                                        |
|                                                                                                                                                                                                                         |         SegmentOrClosed.getSegment-impl(SemaphoreSegment#1): SemaphoreSegment#1 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:447)                                            |
|                                                                                                                                                                                                                         |           ConcurrentLinkedListKt.access$getCLOSED$p(): <CLOSED> at SegmentOrClosed.getSegment-impl(ConcurrentLinkedList.kt:263)                                                      |
|                                                                                                                                                                                                                         |         head.get(): SemaphoreSegment#1 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:447)                                                                                     |
|                                                                                                                                                                                                                         |         SegmentOrClosed.getSegment-impl(SemaphoreSegment#1): SemaphoreSegment#1 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:324)                                            |
|                                                                                                                                                                                                                         |           ConcurrentLinkedListKt.access$getCLOSED$p(): <CLOSED> at SegmentOrClosed.getSegment-impl(ConcurrentLinkedList.kt:263)                                                      |
|                                                                                                                                                                                                                         |         segment.cleanPrev() at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:325)                                                                                                |
|                                                                                                                                                                                                                         |           _prev.lazySet(null) at ConcurrentLinkedListNode.cleanPrev(ConcurrentLinkedList.kt:132)                                                                                     |
|                                                                                                                                                                                                                         |         SemaphoreKt.access$getSEGMENT_SIZE$p(): 16 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:327)                                                                         |
|                                                                                                                                                                                                                         |         SemaphoreKt.access$getPERMIT$p(): <PERMIT> at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:328)                                                                         |
|                                                                                                                                                                                                                         |         segment.getAndSet() at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:328)                                                                                                |
|                                                                                                                                                                                                                         |           getAcquirers(): AtomicReferenceArray#1 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:456)                                                                           |
|                                                                                                                                                                                                                         |           acquirers[0].getAndSet(<PERMIT>): Continuation#5 at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:456)                                                                 |
|                                                                                                                                                                                                                         |         SemaphoreKt.access$getCANCELLED$p(): <CANCELLED> at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:339)                                                                   |
|                                                                                                                                                                                                                         |         tryResumeAcquire(Continuation#5): true at SemaphoreImpl.tryResumeNextFromQueue(Semaphore.kt:340)                                                                             |
|                                                                                                                                                                                                                         |           $this$tryResumeAcquire.tryResume(Unit, null, onCancellationRelease$1): <RESUME_TOKEN> at SemaphoreImpl.tryResumeAcquire(Semaphore.kt:347)                                  |
|                                                                                                                                                                                                                         |             tryResume(Unit, null, onCancellationRelease$1): <RESUME_TOKEN> at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:250)                                     |
|                                                                                                                                                                                                                         |               DebugKt.getASSERTIONS_ENABLED(): true at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:257)                                                            |
|                                                                                                                                                                                                                         |               MutexImpl.access$getOwner$FU$p(): AtomicReferenceFieldUpdaterImpl#1 at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:311)                              |
|                                                                                                                                                                                                                         |               owner.get(): <NO_OWNER> at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:257)                                                                          |
|                                                                                                                                                                                                                         |               MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:257)                                                       |
|                                                                                                                                                                                                                         |               cont.tryResume(Unit, null, token$1): <RESUME_TOKEN> at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:258)                                              |
|                                                                                                                                                                                                                         |                 tryResumeImpl(Unit, null, token$1): <RESUME_TOKEN> at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:582)                                      |
|                                                                                                                                                                                                                         |                   _state.get(): SemaphoreSegment#1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:0)                                                    |
|                                                                                                                                                                                                                         |                   resumeMode ➜ 1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:540)                                                                    |
|                                                                                                                                                                                                                         |                   resumedState(SemaphoreSegment#1, Unit, 1, token$1, null): CompletedContinuation#1 at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:540) |
|                                                                                                                                                                                                                         |                     DispatchedTaskKt.isCancellableMode(1): true at CancellableContinuationImpl.resumedState(CancellableContinuationImpl.kt:489)                                      |
|                                                                                                                                                                                                                         |                   _state.compareAndSet(SemaphoreSegment#1, CompletedContinuation#1): true at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:541)           |
|                                                                                                                                                                                                                         |                   detachChildIfNonResuable() at CancellableContinuationImpl.tryResumeImpl(CancellableContinuationImpl.kt:542)                                                        |
|                                                                                                                                                                                                                         |                     isReusable(): false at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                  |
|                                                                                                                                                                                                                         |                       resumeMode ➜ 1 at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                                                   |
|                                                                                                                                                                                                                         |                       DispatchedTaskKt.isReusableMode(1): false at CancellableContinuationImpl.isReusable(CancellableContinuationImpl.kt:141)                                        |
|                                                                                                                                                                                                                         |                     detachChild() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                        |
|                                                                                                                                                                                                                         |                       getParentHandle(): null at CancellableContinuationImpl.detachChild(CancellableContinuationImpl.kt:572)                                                         |
|                                                                                                                                                                                                                         |                         _parentHandle.get(): null at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                 |
|                                                                                                                                                                                                                         |               DebugKt.getASSERTIONS_ENABLED(): true at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:264)                                                            |
|                                                                                                                                                                                                                         |               MutexImpl.access$getOwner$FU$p(): AtomicReferenceFieldUpdaterImpl#1 at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:311)                              |
|                                                                                                                                                                                                                         |               owner.get(): <NO_OWNER> at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:264)                                                                          |
|                                                                                                                                                                                                                         |               MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:264)                                                       |
|                                                                                                                                                                                                                         |               MutexImpl.access$getOwner$FU$p(): AtomicReferenceFieldUpdaterImpl#1 at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:264)                              |
|                                                                                                                                                                                                                         |               owner.set(null) at MutexImpl$CancellableContinuationWithOwner.tryResume(Mutex.kt:265)                                                                                  |
|                                                                                                                                                                                                                         |           $this$tryResumeAcquire.completeResume(<RESUME_TOKEN>) at SemaphoreImpl.tryResumeAcquire(Semaphore.kt:349)                                                                  |
|                                                                                                                                                                                                                         |             cont.completeResume(<RESUME_TOKEN>) at MutexImpl$CancellableContinuationWithOwner.completeResume(Mutex.kt:0)                                                             |
|                                                                                                                                                                                                                         |               DebugKt.getASSERTIONS_ENABLED(): true at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:589)                                                |
|                                                                                                                                                                                                                         |               resumeMode ➜ 1 at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                       |
|                                                                                                                                                                                                                         |               dispatchResume(1) at CancellableContinuationImpl.completeResume(CancellableContinuationImpl.kt:590)                                                                    |
|                                                                                                                                                                                                                         |                 tryResume(): false at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                 |
|                                                                                                                                                                                                                         |                   _decisionAndIndex.get(): 536870912 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                      |
|                                                                                                                                                                                                                         |                   getDecision() at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:287)                                                                         |
|                                                                                                                                                                                                                         |                 DispatchedTaskKt.dispatch(Continuation#4, 1) at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:474)                                       |
|                                                                                                                                                                                                                         |                   DebugKt.getASSERTIONS_ENABLED(): true at DispatchedTaskKt.dispatch(DispatchedTask.kt:153)                                                                          |
|                                                                                                                                                                                                                         |                   $this$dispatch.getDelegate(): Continuation#3 at DispatchedTaskKt.dispatch(DispatchedTask.kt:154)                                                                   |
|                                                                                                                                                                                                                         |                   DispatchedTaskKt.resume(Continuation#4, Continuation#3, false) at DispatchedTaskKt.dispatch(DispatchedTask.kt:168)                                                 |
|                                                                                                                                                                                                                         |                     $this$resume.takeState(): CompletedContinuation#1 at DispatchedTaskKt.resume(DispatchedTask.kt:174)                                                              |
|                                                                                                                                                                                                                         |                       getState(): CompletedContinuation#1 at CancellableContinuationImpl.takeState(CancellableContinuationImpl.kt:168)                                               |
|                                                                                                                                                                                                                         |                         _state.get(): CompletedContinuation#1 at CancellableContinuationImpl.getState(CancellableContinuationImpl.kt:108)                                            |
|                                                                                                                                                                                                                         |                     $this$resume.getExceptionalResult(CompletedContinuation#1): null at DispatchedTaskKt.resume(DispatchedTask.kt:175)                                               |
|                                                                                                                                                                                                                         |                       getExceptionalResult(CompletedContinuation#1): null at CancellableContinuationImpl.getExceptionalResult(CancellableContinuationImpl.kt:613)                    |
|                                                                                                                                                                                                                         |                     $this$resume.getSuccessfulResult(CompletedContinuation#1) at DispatchedTaskKt.resume(DispatchedTask.kt:176)                                                      |
|                                                                                                                                                                                                                         |                     Result.constructor-impl(Unit) at DispatchedTaskKt.resume(DispatchedTask.kt:176)                                                                                  |
|                                                                                                                                                                                                                         |                     delegate.resumeWith(Unit) at DispatchedTaskKt.resume(DispatchedTask.kt:179)                                                                                      |
|                                                                                                                                                                                                                         |   canEnterForbiddenBlock ➜ true at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:42)                                                                                    |
|                                                                                                                                                                                                                         |   Boxing.boxInt(-1): -1 at SuspendTraceReportingTest.bar(SuspendTraceReportingTest.kt:42)                                                                                            |
|                                                                                                                                                                                                                         |   result: -1                                                                                                                                                                         |
|           _parentHandle.compareAndSet(null, ChildContinuation#1): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                                                           |                                                                                                                                                                                      |
|       DebugProbesKt.probeCoroutineSuspended(Continuation#2) at MutexImpl.lockSuspend(Mutex.kt:311)                                                                                                                      |                                                                                                                                                                                      |
|   ResultKt.throwOnFailure(Unit) at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:27)                                                                                                                       |                                                                                                                                                                                      |
|   counter ➜ 1 at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:31)                                                                                                                                         |                                                                                                                                                                                      |
|   counter = 2 at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:31)                                                                                                                                         |                                                                                                                                                                                      |
|   lock.unlock(null) at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:188)                                                                                                                                  |                                                                                                                                                                                      |
|     isLocked(): true at MutexImpl.unlock(Mutex.kt:213)                                                                                                                                                                  |                                                                                                                                                                                      |
|       getAvailablePermits(): 0 at MutexImpl.isLocked(Mutex.kt:149)                                                                                                                                                      |                                                                                                                                                                                      |
|         _availablePermits.get(): 0 at SemaphoreImpl.getAvailablePermits(Semaphore.kt:152)                                                                                                                               |                                                                                                                                                                                      |
|         Math.max(0, 0): 0 at SemaphoreImpl.getAvailablePermits(Semaphore.kt:152)                                                                                                                                        |                                                                                                                                                                                      |
|     owner.get(): null at MutexImpl.unlock(Mutex.kt:215)                                                                                                                                                                 |                                                                                                                                                                                      |
|     MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl.unlock(Mutex.kt:216)                                                                                                                                        |                                                                                                                                                                                      |
|     MutexKt.access$getNO_OWNER$p(): <NO_OWNER> at MutexImpl.unlock(Mutex.kt:220)                                                                                                                                        |                                                                                                                                                                                      |
|     owner.compareAndSet(null, <NO_OWNER>): true at MutexImpl.unlock(Mutex.kt:220)                                                                                                                                       |                                                                                                                                                                                      |
|     release() at MutexImpl.unlock(Mutex.kt:222)                                                                                                                                                                         |                                                                                                                                                                                      |
|       _availablePermits.getAndIncrement(): 0 at SemaphoreImpl.release(Semaphore.kt:250)                                                                                                                                 |                                                                                                                                                                                      |
|   canEnterForbiddenBlock = false at SuspendTraceReportingTest.foo(SuspendTraceReportingTest.kt:33)                                                                                                                      |                                                                                                                                                                                      |
|   result: void                                                                                                                                                                                                          |                                                                                                                                                                                      |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
