= Invalid execution results =
| ---------------------------------------------------------- |
|                          Thread 1                          |
| ---------------------------------------------------------- |
| incorrectConcurrentLinkedDeque(): IllegalStateException #1 |
| ---------------------------------------------------------- |

---
The number next to an exception name helps you find its stack trace provided after the interleaving section
---

The following interleaving leads to the error:
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                    Thread 1                                                                    |                                                                          Thread 2                                                                           | Thread 3 |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| incorrectConcurrentLinkedDeque(): IllegalStateException #1                                                                                     |                                                                                                                                                             |          |
|   ConcurrentLinkedDeque#1.addLast(1) at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque(CustomThreadsRepresentationTest.kt:112) |                                                                                                                                                             |          |
|   THREAD_START(2)                                                                                                                              |                                                                                                                                                             |          |
|   THREAD_START(3)                                                                                                                              |                                                                                                                                                             |          |
|   switch                                                                                                                                       |                                                                                                                                                             |          |
|                                                                                                                                                | run()                                                                                                                                                       |          |
|                                                                                                                                                |   switch                                                                                                                                                    |          |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |          |
|                                                                                                                                                |                                                                                                                                                             | run()    |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |          |
|                                                                                                                                                |   ConcurrentLinkedDeque#1.pollFirst(): 1 at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$9(CustomThreadsRepresentationTest.kt:114) |          |
|   THREAD_JOIN(2)                                                                                                                               |                                                                                                                                                             |          |
|   THREAD_JOIN(3)                                                                                                                               |                                                                                                                                                             |          |
|   result: IllegalStateException #1                                                                                                             |                                                                                                                                                             |          |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

Exception stack traces:
#1: java.lang.IllegalStateException: Check failed.
	at org.jetbrains.kotlinx.lincheck_test.representation.CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque(CustomThreadsRepresentationTest.kt:123)

Detailed trace:
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                    Thread 1                                                                    |                                                                          Thread 2                                                                           |                                                                          Thread 3                                                                           |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| incorrectConcurrentLinkedDeque(): IllegalStateException #1                                                                                     |                                                                                                                                                             |                                                                                                                                                             |
|   ConcurrentLinkedDeque#1.addLast(1) at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque(CustomThreadsRepresentationTest.kt:112) |                                                                                                                                                             |                                                                                                                                                             |
|     linkLast(1) at ConcurrentLinkedDeque.addLast(ConcurrentLinkedDeque.java:840)                                                               |                                                                                                                                                             |                                                                                                                                                             |
|       ConcurrentLinkedDeque.newNode(1): Node#1 at ConcurrentLinkedDeque.linkLast(ConcurrentLinkedDeque.java:347)                               |                                                                                                                                                             |                                                                                                                                                             |
|         Node#1.item.set(1) at ConcurrentLinkedDeque.newNode(ConcurrentLinkedDeque.java:307)                                                    |                                                                                                                                                             |                                                                                                                                                             |
|       Node#1.prev.set(Node#2) at ConcurrentLinkedDeque.linkLast(ConcurrentLinkedDeque.java:361)                                                |                                                                                                                                                             |                                                                                                                                                             |
|       Node#2.next.compareAndSet(null,Node#1): true at ConcurrentLinkedDeque.linkLast(ConcurrentLinkedDeque.java:362)                           |                                                                                                                                                             |                                                                                                                                                             |
|   THREAD_START(2)                                                                                                                              |                                                                                                                                                             |                                                                                                                                                             |
|   THREAD_START(3)                                                                                                                              |                                                                                                                                                             |                                                                                                                                                             |
|   switch                                                                                                                                       |                                                                                                                                                             |                                                                                                                                                             |
|                                                                                                                                                | run()                                                                                                                                                       |                                                                                                                                                             |
|                                                                                                                                                |   switch                                                                                                                                                    |                                                                                                                                                             |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |                                                                                                                                                             |
|                                                                                                                                                |                                                                                                                                                             | run()                                                                                                                                                       |
|                                                                                                                                                |                                                                                                                                                             |   ConcurrentLinkedDeque#1.addFirst(0) at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$10(CustomThreadsRepresentationTest.kt:117)   |
|                                                                                                                                                |                                                                                                                                                             |     linkFirst(0) at ConcurrentLinkedDeque.addFirst(ConcurrentLinkedDeque.java:827)                                                                          |
|                                                                                                                                                |                                                                                                                                                             |       ConcurrentLinkedDeque.newNode(0): Node#3 at ConcurrentLinkedDeque.linkFirst(ConcurrentLinkedDeque.java:315)                                           |
|                                                                                                                                                |                                                                                                                                                             |         Node#3.item.set(0) at ConcurrentLinkedDeque.newNode(ConcurrentLinkedDeque.java:307)                                                                 |
|                                                                                                                                                |                                                                                                                                                             |       Node#3.next.set(Node#2) at ConcurrentLinkedDeque.linkFirst(ConcurrentLinkedDeque.java:329)                                                            |
|                                                                                                                                                |                                                                                                                                                             |       Node#2.prev.compareAndSet(null,Node#3): true at ConcurrentLinkedDeque.linkFirst(ConcurrentLinkedDeque.java:330)                                       |
|                                                                                                                                                |                                                                                                                                                             |   ConcurrentLinkedDeque#1.peekLast(): 1 at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$10(CustomThreadsRepresentationTest.kt:118) |
|                                                                                                                                                |                                                                                                                                                             |     last(): Node#1 at ConcurrentLinkedDeque.peekLast(ConcurrentLinkedDeque.java:887)                                                                        |
|                                                                                                                                                |                                                                                                                                                             |       tail.compareAndSet(Node#2,Node#1): true at ConcurrentLinkedDeque.last(ConcurrentLinkedDeque.java:746)                                                 |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |                                                                                                                                                             |
|                                                                                                                                                |   ConcurrentLinkedDeque#1.pollFirst(): 1 at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$9(CustomThreadsRepresentationTest.kt:114) |                                                                                                                                                             |
|                                                                                                                                                |     Node#1.item.compareAndSet(1,null): true at ConcurrentLinkedDeque.pollFirst(ConcurrentLinkedDeque.java:920)                                              |                                                                                                                                                             |
|                                                                                                                                                |     unlink(Node#1) at ConcurrentLinkedDeque.pollFirst(ConcurrentLinkedDeque.java:921)                                                                       |                                                                                                                                                             |
|                                                                                                                                                |       unlinkLast(Node#1,Node#2) at ConcurrentLinkedDeque.unlink(ConcurrentLinkedDeque.java:391)                                                             |                                                                                                                                                             |
|                                                                                                                                                |         Node#1.prev.compareAndSet(Node#2,Node#3): true at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:533)                                  |                                                                                                                                                             |
|                                                                                                                                                |         skipDeletedSuccessors(Node#3) at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:534)                                                   |                                                                                                                                                             |
|                                                                                                                                                |           Node#3.next.compareAndSet(Node#2,Node#1): true at ConcurrentLinkedDeque.skipDeletedSuccessors(ConcurrentLinkedDeque.java:674)                     |                                                                                                                                                             |
|                                                                                                                                                |         updateHead() at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:539)                                                                    |                                                                                                                                                             |
|                                                                                                                                                |           head.compareAndSet(Node#2,Node#3): true at ConcurrentLinkedDeque.updateHead(ConcurrentLinkedDeque.java:575)                                       |                                                                                                                                                             |
|                                                                                                                                                |         Node#2.prev.setRelease(Node#2) at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:543)                                                  |                                                                                                                                                             |
|                                                                                                                                                |         Node#2.next.setRelease(Node#4) at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:544)                                                  |                                                                                                                                                             |
|   THREAD_JOIN(2)                                                                                                                               |                                                                                                                                                             |                                                                                                                                                             |
|   THREAD_JOIN(3)                                                                                                                               |                                                                                                                                                             |                                                                                                                                                             |
|   result: IllegalStateException #1                                                                                                             |                                                                                                                                                             |                                                                                                                                                             |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
