= Invalid execution results =
| ----------------------- |
|  Thread 1   | Thread 2  |
| ----------------------- |
| foo(): void | bar(): -1 |
| ----------------------- |

The following interleaving leads to the error:
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                              Thread 1                                                              |                                                    Thread 2                                                     |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                    | bar(): -1                                                                                                       |
|                                                                                                                                    |   barStarted.WRITE(true) at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:76)            |
|                                                                                                                                    |   switch                                                                                                        |
| foo()                                                                                                                              |                                                                                                                 |
|   barStarted.READ: true at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:69)                                |                                                                                                                 |
|   canEnterForbiddenBlock.WRITE(true) at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:69)                   |                                                                                                                 |
|   function1(): Unit#1 at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:70)                                  |                                                                                                                 |
|     counter.READ: 0 at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:85)                              |                                                                                                                 |
|     counter.WRITE(1) at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:85)                             |                                                                                                                 |
|     function2(): Unit#1 at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:86)                          |                                                                                                                 |
|       counter.READ: 1 at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:91)                            |                                                                                                                 |
|       counter.WRITE(2) at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:91)                           |                                                                                                                 |
|       function3(): Unit#1 at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:92)                        |                                                                                                                 |
|         counter.READ: 2 at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:97)                          |                                                                                                                 |
|         counter.WRITE(3) at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:97)                         |                                                                                                                 |
|         continuation.WRITE(<cont>) at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:99)               |                                                                                                                 |
|         <cont>.getOrThrow(): COROUTINE_SUSPENDED at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:98) |                                                                                                                 |
|           result.READ: UNDECIDED at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:51)                                         |                                                                                                                 |
|           result.compareAndSet(UNDECIDED,COROUTINE_SUSPENDED): true at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:53)      |                                                                                                                 |
|   switch (reason: coroutine is suspended)                                                                                          |                                                                                                                 |
|                                                                                                                                    |   continuation.READ: <cont> at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:77)         |
|                                                                                                                                    |   continuation.READ: <cont> at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:78)         |
|                                                                                                                                    |   <cont>.resumeWith(Unit#1) at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:78)         |
|                                                                                                                                    |   canEnterForbiddenBlock.READ: true at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:79) |
|                                                                                                                                    |   result: -1                                                                                                    |
|         counter.READ: 3 at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:101)                         |                                                                                                                 |
|         counter.WRITE(4) at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:101)                        |                                                                                                                 |
|       counter.READ: 4 at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:93)                            |                                                                                                                 |
|       counter.WRITE(5) at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:93)                           |                                                                                                                 |
|     counter.READ: 5 at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:87)                              |                                                                                                                 |
|     counter.WRITE(6) at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:87)                             |                                                                                                                 |
|   canEnterForbiddenBlock.WRITE(false) at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:71)                  |                                                                                                                 |
|   result: void                                                                                                                     |                                                                                                                 |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

Detailed trace:
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                              Thread 1                                                              |                                                       Thread 2                                                        |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                    | bar(): -1                                                                                                             |
|                                                                                                                                    |   barStarted.WRITE(true) at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:76)                  |
|                                                                                                                                    |   switch                                                                                                              |
| foo()                                                                                                                              |                                                                                                                       |
|   barStarted.READ: true at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:69)                                |                                                                                                                       |
|   canEnterForbiddenBlock.WRITE(true) at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:69)                   |                                                                                                                       |
|   function1(): Unit#1 at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:70)                                  |                                                                                                                       |
|     counter.READ: 0 at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:85)                              |                                                                                                                       |
|     counter.WRITE(1) at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:85)                             |                                                                                                                       |
|     function2(): Unit#1 at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:86)                          |                                                                                                                       |
|       counter.READ: 1 at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:91)                            |                                                                                                                       |
|       counter.WRITE(2) at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:91)                           |                                                                                                                       |
|       function3(): Unit#1 at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:92)                        |                                                                                                                       |
|         counter.READ: 2 at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:97)                          |                                                                                                                       |
|         counter.WRITE(3) at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:97)                         |                                                                                                                       |
|         continuation.WRITE(<cont>) at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:99)               |                                                                                                                       |
|         <cont>.getOrThrow(): COROUTINE_SUSPENDED at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:98) |                                                                                                                       |
|           result.READ: UNDECIDED at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:51)                                         |                                                                                                                       |
|           result.compareAndSet(UNDECIDED,COROUTINE_SUSPENDED): true at SafeContinuation.getOrThrow(SafeContinuationJvm.kt:53)      |                                                                                                                       |
|   switch (reason: coroutine is suspended)                                                                                          |                                                                                                                       |
|                                                                                                                                    |   continuation.READ: <cont> at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:77)               |
|                                                                                                                                    |   continuation.READ: <cont> at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:78)               |
|                                                                                                                                    |   <cont>.resumeWith(Unit#1) at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:78)               |
|                                                                                                                                    |     result.READ: COROUTINE_SUSPENDED at SafeContinuation.resumeWith(SafeContinuationJvm.kt:37)                        |
|                                                                                                                                    |     result.compareAndSet(COROUTINE_SUSPENDED,RESUMED): true at SafeContinuation.resumeWith(SafeContinuationJvm.kt:40) |
|                                                                                                                                    |   canEnterForbiddenBlock.READ: true at SuspendTraceResumptionReportingTest.bar(SuspendTraceReportingTest.kt:79)       |
|                                                                                                                                    |   result: -1                                                                                                          |
|         counter.READ: 3 at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:101)                         |                                                                                                                       |
|         counter.WRITE(4) at SuspendTraceResumptionReportingTest.function3(SuspendTraceReportingTest.kt:101)                        |                                                                                                                       |
|       counter.READ: 4 at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:93)                            |                                                                                                                       |
|       counter.WRITE(5) at SuspendTraceResumptionReportingTest.function2(SuspendTraceReportingTest.kt:93)                           |                                                                                                                       |
|     counter.READ: 5 at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:87)                              |                                                                                                                       |
|     counter.WRITE(6) at SuspendTraceResumptionReportingTest.function1(SuspendTraceReportingTest.kt:87)                             |                                                                                                                       |
|   canEnterForbiddenBlock.WRITE(false) at SuspendTraceResumptionReportingTest.foo(SuspendTraceReportingTest.kt:71)                  |                                                                                                                       |
|   result: void                                                                                                                     |                                                                                                                       |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
