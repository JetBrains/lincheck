= Invalid execution results =
| ---------------------------------------------------------- |
|                          Thread 1                          |
| ---------------------------------------------------------- |
| incorrectConcurrentLinkedDeque(): IllegalStateException #1 |
| ---------------------------------------------------------- |

---
The number next to an exception name helps you find its stack trace provided after the interleaving section
---

The following interleaving leads to the error:
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                    Thread 1                                                                    |                                                                          Thread 2                                                                           | Thread 3 |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| incorrectConcurrentLinkedDeque(): IllegalStateException #1                                                                                     |                                                                                                                                                             |          |
|   ConcurrentLinkedDeque#1.addLast(1) at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque(CustomThreadsRepresentationTest.kt:112) |                                                                                                                                                             |          |
|   THREAD_START(2)                                                                                                                              |                                                                                                                                                             |          |
|   THREAD_START(3)                                                                                                                              |                                                                                                                                                             |          |
|   switch                                                                                                                                       |                                                                                                                                                             |          |
|                                                                                                                                                | run()                                                                                                                                                       |          |
|                                                                                                                                                |   switch                                                                                                                                                    |          |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |          |
|                                                                                                                                                |                                                                                                                                                             | run()    |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |          |
|                                                                                                                                                |   ConcurrentLinkedDeque#1.pollFirst(): 1 at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$9(CustomThreadsRepresentationTest.kt:114) |          |
|   THREAD_JOIN(2)                                                                                                                               |                                                                                                                                                             |          |
|   THREAD_JOIN(3)                                                                                                                               |                                                                                                                                                             |          |
|   result: IllegalStateException #1                                                                                                             |                                                                                                                                                             |          |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

Exception stack traces:
#1: java.lang.IllegalStateException: Check failed.
	at org.jetbrains.kotlinx.lincheck_test.representation.CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque(CustomThreadsRepresentationTest.kt:123)

Detailed trace:
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                    Thread 1                                                                    |                                                                          Thread 2                                                                           |                                                                          Thread 3                                                                           |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| incorrectConcurrentLinkedDeque(): IllegalStateException #1                                                                                     |                                                                                                                                                             |                                                                                                                                                             |
|   ConcurrentLinkedDeque#1.addLast(1) at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque(CustomThreadsRepresentationTest.kt:112) |                                                                                                                                                             |                                                                                                                                                             |
|     linkLast(1) at ConcurrentLinkedDeque.addLast(ConcurrentLinkedDeque.java:903)                                                               |                                                                                                                                                             |                                                                                                                                                             |
|       Node#2.casNext(null,Node#1): true at ConcurrentLinkedDeque.linkLast(ConcurrentLinkedDeque.java:402)                                      |                                                                                                                                                             |                                                                                                                                                             |
|         next.compareAndSwapObject(null,Node#1): true at ConcurrentLinkedDeque$Node.casNext(ConcurrentLinkedDeque.java:315)                     |                                                                                                                                                             |                                                                                                                                                             |
|   THREAD_START(2)                                                                                                                              |                                                                                                                                                             |                                                                                                                                                             |
|   THREAD_START(3)                                                                                                                              |                                                                                                                                                             |                                                                                                                                                             |
|   switch                                                                                                                                       |                                                                                                                                                             |                                                                                                                                                             |
|                                                                                                                                                | run()                                                                                                                                                       |                                                                                                                                                             |
|                                                                                                                                                |   switch                                                                                                                                                    |                                                                                                                                                             |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |                                                                                                                                                             |
|                                                                                                                                                |                                                                                                                                                             | run()                                                                                                                                                       |
|                                                                                                                                                |                                                                                                                                                             |   ConcurrentLinkedDeque#1.addFirst(0) at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$10(CustomThreadsRepresentationTest.kt:117)   |
|                                                                                                                                                |                                                                                                                                                             |     linkFirst(0) at ConcurrentLinkedDeque.addFirst(ConcurrentLinkedDeque.java:890)                                                                          |
|                                                                                                                                                |                                                                                                                                                             |       Node#2.casPrev(null,Node#3): true at ConcurrentLinkedDeque.linkFirst(ConcurrentLinkedDeque.java:369)                                                  |
|                                                                                                                                                |                                                                                                                                                             |         prev.compareAndSwapObject(null,Node#3): true at ConcurrentLinkedDeque$Node.casPrev(ConcurrentLinkedDeque.java:323)                                  |
|                                                                                                                                                |                                                                                                                                                             |   ConcurrentLinkedDeque#1.peekLast(): 1 at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$10(CustomThreadsRepresentationTest.kt:118) |
|                                                                                                                                                |                                                                                                                                                             |     last(): Node#1 at ConcurrentLinkedDeque.peekLast(ConcurrentLinkedDeque.java:942)                                                                        |
|                                                                                                                                                |                                                                                                                                                             |       casTail(Node#2,Node#1): true at ConcurrentLinkedDeque.last(ConcurrentLinkedDeque.java:782)                                                            |
|                                                                                                                                                |                                                                                                                                                             |         tail.compareAndSwapObject(Node#2,Node#1): true at ConcurrentLinkedDeque.casTail(ConcurrentLinkedDeque.java:1562)                                    |
|   switch (reason: waiting for thread to join)                                                                                                  |                                                                                                                                                             |                                                                                                                                                             |
|                                                                                                                                                |   ConcurrentLinkedDeque#1.pollFirst(): 1 at CustomThreadsRepresentationTest.incorrectConcurrentLinkedDeque$lambda$9(CustomThreadsRepresentationTest.kt:114) |                                                                                                                                                             |
|                                                                                                                                                |     Node#1.casItem(1,null): true at ConcurrentLinkedDeque.pollFirst(ConcurrentLinkedDeque.java:967)                                                         |                                                                                                                                                             |
|                                                                                                                                                |       item.compareAndSwapObject(1,null): true at ConcurrentLinkedDeque$Node.casItem(ConcurrentLinkedDeque.java:307)                                         |                                                                                                                                                             |
|                                                                                                                                                |     unlink(Node#1) at ConcurrentLinkedDeque.pollFirst(ConcurrentLinkedDeque.java:968)                                                                       |                                                                                                                                                             |
|                                                                                                                                                |       unlinkLast(Node#1,Node#2) at ConcurrentLinkedDeque.unlink(ConcurrentLinkedDeque.java:431)                                                             |                                                                                                                                                             |
|                                                                                                                                                |         Node#1.casPrev(Node#2,Node#3): true at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:571)                                             |                                                                                                                                                             |
|                                                                                                                                                |           prev.compareAndSwapObject(Node#2,Node#3): true at ConcurrentLinkedDeque$Node.casPrev(ConcurrentLinkedDeque.java:323)                              |                                                                                                                                                             |
|                                                                                                                                                |         skipDeletedSuccessors(Node#3) at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:572)                                                   |                                                                                                                                                             |
|                                                                                                                                                |           Node#3.casNext(Node#2,Node#1): true at ConcurrentLinkedDeque.skipDeletedSuccessors(ConcurrentLinkedDeque.java:712)                                |                                                                                                                                                             |
|                                                                                                                                                |             next.compareAndSwapObject(Node#2,Node#1): true at ConcurrentLinkedDeque$Node.casNext(ConcurrentLinkedDeque.java:315)                            |                                                                                                                                                             |
|                                                                                                                                                |         updateHead() at ConcurrentLinkedDeque.unlinkLast(ConcurrentLinkedDeque.java:577)                                                                    |                                                                                                                                                             |
|                                                                                                                                                |           casHead(Node#2,Node#3): true at ConcurrentLinkedDeque.updateHead(ConcurrentLinkedDeque.java:613)                                                  |                                                                                                                                                             |
|                                                                                                                                                |             head.compareAndSwapObject(Node#2,Node#3): true at ConcurrentLinkedDeque.casHead(ConcurrentLinkedDeque.java:1558)                                |                                                                                                                                                             |
|   THREAD_JOIN(2)                                                                                                                               |                                                                                                                                                             |                                                                                                                                                             |
|   THREAD_JOIN(3)                                                                                                                               |                                                                                                                                                             |                                                                                                                                                             |
|   result: IllegalStateException #1                                                                                                             |                                                                                                                                                             |                                                                                                                                                             |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
