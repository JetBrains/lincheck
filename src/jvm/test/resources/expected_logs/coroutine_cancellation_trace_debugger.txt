= Invalid execution results =
| ---------------------------------------------------- |
|     Thread 1     |             Thread 2              |
| ---------------------------------------------------- |
| isAbsurd(): true | cancelledOp() + cancel: CANCELLED |
| ---------------------------------------------------- |

The following interleaving leads to the error:
| -------------------------------------------- |
|     Thread 1      |         Thread 2         |
| -------------------------------------------- |
| isAbsurd(): true  |                          |
|   correct ➜ true  |                          |
|   switch          |                          |
|                   | cancelledOp(): CANCELLED |
|   correct ➜ false |                          |
|   result: true    |                          |
| -------------------------------------------- |

Detailed trace:
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                           Thread 1                                                           |                                                                                                     Thread 2                                                                                                     |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| isAbsurd(): true                                                                                                             |                                                                                                                                                                                                                  |
|   correct ➜ true at CoroutineCancellationTraceReportingTest.<unknown method>(CoroutineCancellationTraceReportingTest.kt:36)  |                                                                                                                                                                                                                  |
|   switch                                                                                                                     |                                                                                                                                                                                                                  |
|                                                                                                                              | cancelledOp(): CANCELLED                                                                                                                                                                                         |
|                                                                                                                              |   DebugKt.getASSERTIONS_ENABLED(): true at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:38)                                                                                       |
|                                                                                                                              |   delegate.getContext(): CombinedContext#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:41)                                                                                    |
|                                                                                                                              |   decisionAndIndex() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:72)                                                                                                          |
|                                                                                                                              |   cancellable.initCancellability() at CancellableContinuationKt.<unknown method>(CancellableContinuation.kt:321)                                                                                                 |
|                                                                                                                              |     installParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:129)                                                                               |
|                                                                                                                              |       getContext(): CombinedContext#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:346)                                                                                        |
|                                                                                                                              |       context.get(Key#1): JobImpl#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:346)                                                                                          |
|                                                                                                                              |         CoroutineContext.Element.DefaultImpls.get(JobImpl#1, Key#1): JobImpl#1 at Job.DefaultImpls.get(Job.kt:112)                                                                                               |
|                                                                                                                              |           getKey(): Key#1 at CoroutineContext.Element.DefaultImpls.get(CoroutineContext.kt:67)                                                                                                                   |
|                                                                                                                              |       getAsHandler() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:350)                                                                                                         |
|                                                                                                                              |       Job.DefaultImpls.invokeOnCompletion$default(JobImpl#1, true, false, ChildContinuation#1, 2, null): ChildContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:348) |
|                                                                                                                              |         JobImpl#1.invokeOnCompletion(true, true, ChildContinuation#1): ChildContinuation#1 at Job.DefaultImpls.invokeOnCompletion$default(Job.kt:357)                                                            |
|                                                                                                                              |           job = JobImpl#1 at JobNode.setJob(JobSupport.kt:1348)                                                                                                                                                  |
|                                                                                                                              |       _parentHandle.compareAndSet(null, ChildContinuation#1): true at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:352)                                                           |
|                                                                                                                              |     isCompleted(): false at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:134)                                                                                                     |
|                                                                                                                              |       getState(): Active#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:112)                                                                                                   |
|                                                                                                                              |         _state.get(): Active#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:108)                                                                                               |
|                                                                                                                              |   cont.invokeOnCancellation(cancelledOp$2$1) at CoroutineCancellationTraceReportingTest.<unknown method>(CoroutineCancellationTraceReportingTest.kt:29)                                                          |
|                                                                                                                              |     makeCancelHandler(cancelledOp$2$1): InvokeOnCancel#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:398)                                                                     |
|                                                                                                                              |     invokeOnCancellationImpl(InvokeOnCancel#1) at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:399)                                                                               |
|                                                                                                                              |       DebugKt.getASSERTIONS_ENABLED(): true at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:403)                                                                                  |
|                                                                                                                              |       _state.get(): Active#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:403)                                                                                                 |
|                                                                                                                              |       _state.compareAndSet(Active#1, InvokeOnCancel#1): true at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:407)                                                                 |
|                                                                                                                              |   cancellable.getResult(): COROUTINE_SUSPENDED at CancellableContinuationKt.<unknown method>(CancellableContinuation.kt:323)                                                                                     |
|                                                                                                                              |     isReusable(): false at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:297)                                                                                                      |
|                                                                                                                              |       resumeMode ➜ 1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:141)                                                                                                         |
|                                                                                                                              |       DispatchedTaskKt.isReusableMode(1): false at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:141)                                                                              |
|                                                                                                                              |     trySuspend(): true at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:300)                                                                                                       |
|                                                                                                                              |       _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                                             |
|                                                                                                                              |       getDecision() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:277)                                                                                                          |
|                                                                                                                              |       getIndex() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:278)                                                                                                             |
|                                                                                                                              |       decisionAndIndex() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:278)                                                                                                     |
|                                                                                                                              |       _decisionAndIndex.compareAndSet(536870911, 1073741823): true at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:278)                                                           |
|                                                                                                                              |     getParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:310)                                                                                   |
|                                                                                                                              |       _parentHandle.get(): ChildContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:106)                                                                               |
|                                                                                                                              |   DebugProbesKt.probeCoroutineSuspended(Continuation#2) at CancellableContinuationKt.<unknown method>(CancellableContinuation.kt:314)                                                                            |
|                                                                                                                              |   CANCELLED BEFORE RESUMPTION                                                                                                                                                                                    |
|                                                                                                                              |   _state.get(): InvokeOnCancel#1 at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:0)                                                                                                         |
|                                                                                                                              |   _state.compareAndSet(InvokeOnCancel#1, CancelledContinuation#1): true at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:209)                                                      |
|                                                                                                                              |   callCancelHandler(InvokeOnCancel#1, Exception#1) at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:212)                                                                           |
|                                                                                                                              |     callCancelHandlerSafely() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:249)                                                                                                |
|                                                                                                                              |       callCancelHandlerSafely$Lambda() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:231)                                                                                       |
|                                                                                                                              |         handler.invoke(Exception#1) at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:249)                                                                                          |
|                                                                                                                              |           handler.invoke(Exception#1) at InvokeOnCancel.invoke(CancellableContinuationImpl.kt:642)                                                                                                               |
|                                                                                                                              |             invoke(Exception#1) at CoroutineCancellationTraceReportingTest$cancelledOp$2$1.invoke(CoroutineCancellationTraceReportingTest.kt:29)                                                                 |
|                                                                                                                              |               setCorrect(false) at CoroutineCancellationTraceReportingTest$cancelledOp$2$1.invoke(CoroutineCancellationTraceReportingTest.kt:30)                                                                 |
|                                                                                                                              |                 correct = false at CoroutineCancellationTraceReportingTest.<unknown method>(CoroutineCancellationTraceReportingTest.kt:22)                                                                       |
|                                                                                                                              |   detachChildIfNonResuable() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:216)                                                                                                 |
|                                                                                                                              |     isReusable(): false at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:565)                                                                                                      |
|                                                                                                                              |       resumeMode ➜ 1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:141)                                                                                                         |
|                                                                                                                              |       DispatchedTaskKt.isReusableMode(1): false at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:141)                                                                              |
|                                                                                                                              |     detachChild() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:565)                                                                                                            |
|                                                                                                                              |       getParentHandle(): ChildContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:572)                                                                                 |
|                                                                                                                              |         _parentHandle.get(): ChildContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:106)                                                                             |
|                                                                                                                              |       handle.dispose() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:573)                                                                                                       |
|                                                                                                                              |         getJob(): JobImpl#1 at JobNode.dispose(JobSupport.kt:1351)                                                                                                                                               |
|                                                                                                                              |           job ➜ JobImpl#1 at JobNode.getJob(JobSupport.kt:1348)                                                                                                                                                  |
|                                                                                                                              |         job.removeNode(ChildContinuation#1) at JobNode.dispose(JobSupport.kt:1351)                                                                                                                               |
|                                                                                                                              |       _parentHandle.set(NonDisposableHandle#1) at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:574)                                                                               |
|                                                                                                                              |   resumeMode ➜ 1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:217)                                                                                                             |
|                                                                                                                              |   dispatchResume(1) at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:217)                                                                                                          |
|                                                                                                                              |     tryResume(): false at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:472)                                                                                                       |
|                                                                                                                              |       _decisionAndIndex.get(): 1073741823 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                                                             |
|                                                                                                                              |       getDecision() at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:287)                                                                                                          |
|                                                                                                                              |     DispatchedTaskKt.dispatch(Continuation#1, 1) at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:474)                                                                             |
|                                                                                                                              |       DebugKt.getASSERTIONS_ENABLED(): true at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:153)                                                                                                          |
|                                                                                                                              |       $this$dispatch.getDelegate(): Continuation#2 at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:154)                                                                                                   |
|                                                                                                                              |       DispatchedTaskKt.resume(Continuation#1, Continuation#2, false) at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:168)                                                                                 |
|                                                                                                                              |         $this$resume.takeState(): CancelledContinuation#1 at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:174)                                                                                            |
|                                                                                                                              |           getState(): CancelledContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:168)                                                                                |
|                                                                                                                              |             _state.get(): CancelledContinuation#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:108)                                                                            |
|                                                                                                                              |         $this$resume.getExceptionalResult(CancelledContinuation#1): Exception#1 at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:175)                                                                      |
|                                                                                                                              |           getExceptionalResult(CancelledContinuation#1): Exception#1 at CancellableContinuationImpl.<unknown method>(CancellableContinuationImpl.kt:613)                                                         |
|                                                                                                                              |           DebugKt.getRECOVER_STACK_TRACES(): true at StackTraceRecoveryKt.<unknown method>(StackTraceRecovery.kt:61)                                                                                             |
|                                                                                                                              |         ResultKt.createFailure(Exception#1): Failure#1 at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:176)                                                                                               |
|                                                                                                                              |         Result.constructor-impl(Failure#1): Failure#1 at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:176)                                                                                                |
|                                                                                                                              |         delegate.resumeWith(Failure#1) at DispatchedTaskKt.<unknown method>(DispatchedTask.kt:179)                                                                                                               |
|                                                                                                                              |   result: CANCELLED                                                                                                                                                                                              |
|   correct ➜ false at CoroutineCancellationTraceReportingTest.<unknown method>(CoroutineCancellationTraceReportingTest.kt:36) |                                                                                                                                                                                                                  |
|   result: true                                                                                                               |                                                                                                                                                                                                                  |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
