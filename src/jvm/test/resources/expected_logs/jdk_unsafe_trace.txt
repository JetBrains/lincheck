= Invalid execution results =
| ------------------------------- |
|    Thread 1    |    Thread 2    |
| ------------------------------- |
| increment(): 0 | increment(): 0 |
| ------------------------------- |

The following interleaving leads to the error:
| -------------------------------------------------------------------------------------------------------------------------------------------- |
|    Thread 1    |                                                          Thread 2                                                           |
| -------------------------------------------------------------------------------------------------------------------------------------------- |
|                | increment(): 0                                                                                                              |
|                |   counter.READ: 0 at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:80)       |
|                |   switch                                                                                                                    |
| increment(): 0 |                                                                                                                             |
|                |   counter.WRITE(1) at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:80)      |
|                |   actionsJustForTrace() at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:81) |
|                |   result: 0                                                                                                                 |
| -------------------------------------------------------------------------------------------------------------------------------------------- |

Detailed trace:
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                 Thread 1                                                                 |                                                               Thread 2                                                                |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                                                                          | increment(): 0                                                                                                                        |
|                                                                                                                                          |   counter.READ: 0 at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:80)                 |
|                                                                                                                                          |   switch                                                                                                                              |
| increment(): 0                                                                                                                           |                                                                                                                                       |
|   counter.READ: 0 at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:80)                    |                                                                                                                                       |
|   counter.WRITE(1) at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:80)                   |                                                                                                                                       |
|   actionsJustForTrace() at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:81)              |                                                                                                                                       |
|     hashMap.put(1,2): null at JdkUnsafeTraceRepresentationTest.actionsJustForTrace(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:97) |                                                                                                                                       |
|       putVal(1,2,false): null at ConcurrentHashMap.put(ConcurrentHashMap.java:1006)                                                      |                                                                                                                                       |
|         table.READ: null at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1014)                                                        |                                                                                                                                       |
|         initTable(): Array<Node>#1 at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1017)                                              |                                                                                                                                       |
|           table.READ: null at ConcurrentHashMap.initTable(ConcurrentHashMap.java:2293)                                                   |                                                                                                                                       |
|           sizeCtl.READ: 0 at ConcurrentHashMap.initTable(ConcurrentHashMap.java:2294)                                                    |                                                                                                                                       |
|           sizeCtl.compareAndSetInt(0,-1): true at ConcurrentHashMap.initTable(ConcurrentHashMap.java:2296)                               |                                                                                                                                       |
|           table.READ: null at ConcurrentHashMap.initTable(ConcurrentHashMap.java:2298)                                                   |                                                                                                                                       |
|           table.WRITE(Array<Node>#1) at ConcurrentHashMap.initTable(ConcurrentHashMap.java:2302)                                         |                                                                                                                                       |
|           sizeCtl.WRITE(12) at ConcurrentHashMap.initTable(ConcurrentHashMap.java:2306)                                                  |                                                                                                                                       |
|         ConcurrentHashMap.tabAt(Array<Node>#1,1): null at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1018)                          |                                                                                                                                       |
|           Array<Node>#1[1].getReferenceAcquire(): null at ConcurrentHashMap.tabAt(ConcurrentHashMap.java:760)                            |                                                                                                                                       |
|         ConcurrentHashMap.casTabAt(Array<Node>#1,1,null,Node#1): true at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1019)           |                                                                                                                                       |
|           Array<Node>#1[1].compareAndSetReference(null,Node#1): true at ConcurrentHashMap.casTabAt(ConcurrentHashMap.java:765)           |                                                                                                                                       |
|         addCount(1,0) at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1075)                                                           |                                                                                                                                       |
|           counterCells.READ: null at ConcurrentHashMap.addCount(ConcurrentHashMap.java:2326)                                             |                                                                                                                                       |
|           baseCount.READ: 0 at ConcurrentHashMap.addCount(ConcurrentHashMap.java:2326)                                                   |                                                                                                                                       |
|           baseCount.compareAndSetLong(0,1): true at ConcurrentHashMap.addCount(ConcurrentHashMap.java:2327)                              |                                                                                                                                       |
|           sizeCtl.READ: 12 at ConcurrentHashMap.addCount(ConcurrentHashMap.java:2343)                                                    |                                                                                                                                       |
|   result: 0                                                                                                                              |                                                                                                                                       |
|                                                                                                                                          |   counter.WRITE(1) at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:80)                |
|                                                                                                                                          |   actionsJustForTrace() at JdkUnsafeTraceRepresentationTest.increment(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:81)           |
|                                                                                                                                          |     hashMap.put(1,2): 2 at JdkUnsafeTraceRepresentationTest.actionsJustForTrace(UnsafeUpdaterVarHandleTraceRepresentationTests.kt:97) |
|                                                                                                                                          |       putVal(1,2,false): 2 at ConcurrentHashMap.put(ConcurrentHashMap.java:1006)                                                      |
|                                                                                                                                          |         table.READ: Array<Node>#1 at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1014)                                            |
|                                                                                                                                          |         ConcurrentHashMap.tabAt(Array<Node>#1,1): Node#1 at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1018)                     |
|                                                                                                                                          |           Array<Node>#1[1].getReferenceAcquire(): Node#1 at ConcurrentHashMap.tabAt(ConcurrentHashMap.java:760)                       |
|                                                                                                                                          |         MONITORENTER at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1031)                                                         |
|                                                                                                                                          |         ConcurrentHashMap.tabAt(Array<Node>#1,1): Node#1 at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1032)                     |
|                                                                                                                                          |           Array<Node>#1[1].getReferenceAcquire(): Node#1 at ConcurrentHashMap.tabAt(ConcurrentHashMap.java:760)                       |
|                                                                                                                                          |         val.READ: 2 at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1040)                                                   |
|                                                                                                                                   |         val.WRITE(2) at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1042)                                                  |
|                                                                                                                                   |         MONITOREXIT at ConcurrentHashMap.putVal(ConcurrentHashMap.java:1065)                                                          |
|                                                                                                                                          |   result: 0                                                                                                                           |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
