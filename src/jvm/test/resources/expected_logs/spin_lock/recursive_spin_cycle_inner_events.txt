= The execution has hung =
| ------------------------------------------ |
|    Thread 1     |         Thread 2         |
| ------------------------------------------ |
| trigger(): void | causesSpinLock(): <hung> |
| ------------------------------------------ |


The following interleaving leads to the error:
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                   Thread 1                                                   |                                                            Thread 2                                                             |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| trigger()                                                                                                    |                                                                                                                                 |
|   counter.incrementAndGet(): 1 at RecursiveSpinLockWithInnerEventsTest.trigger(RecursiveSpinLockTest.kt:126) |                                                                                                                                 |
|   switch                                                                                                     |                                                                                                                                 |
|                                                                                                              |   causesSpinLock(): <hung>                                                                                                      |
|                                                                                                              |     counter.get(): 1 at RecursiveSpinLockWithInnerEventsTest.causesSpinLock(RecursiveSpinLockTest.kt:132)                       |
|                                                                                                              |     /* The following events repeat infinitely: */                                                                               |
|                                                                                                              | ┌╶> deadSpinCycleRecursive() at RecursiveSpinLockWithInnerEventsTest.causesSpinLock(RecursiveSpinLockTest.kt:133)               |
|                                                                                                              | |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)   |
|                                                                                                              | |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)          |
|                                                                                                              | |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)    |
|                                                                                                              | |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)           |
|                                                                                                              | |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)   |
|                                                                                                              | |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)          |
|                                                                                                              | |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)    |
|                                                                                                              | |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)           |
|                                                                                                              | └╶╶╶╶ switch (reason: active lock detected)                                                                                     |
|   counter.decrementAndGet(): 0 at RecursiveSpinLockWithInnerEventsTest.trigger(RecursiveSpinLockTest.kt:127) |                                                                                                                                 |
|   result: void                                                                                               |                                                                                                                                 |
|                                                                                                              |       /* The following events repeat infinitely: */                                                                             |
|                                                                                                              |   ┌╶> deadSpinCycleRecursive() at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:142)     |
|                                                                                                              |   |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139) |
|                                                                                                              |   |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)        |
|                                                                                                              |   |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)  |
|                                                                                                              |   |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)         |
|                                                                                                              |   |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139) |
|                                                                                                              |   |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)        |
|                                                                                                              |   |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)  |
|                                                                                                              |   |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)         |
|                                                                                                              |   └╶╶╶╶ switch (reason: active lock detected)                                                                                   |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
All unfinished threads are in deadlock

Detailed trace:
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                   Thread 1                                                   |                                                                    Thread 2                                                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| trigger()                                                                                                    |                                                                                                                                                |
|   counter.incrementAndGet(): 1 at RecursiveSpinLockWithInnerEventsTest.trigger(RecursiveSpinLockTest.kt:126) |                                                                                                                                                |
|   switch                                                                                                     |                                                                                                                                                |
|                                                                                                              |   causesSpinLock(): <hung>                                                                                                                     |
|                                                                                                              |     counter.get(): 1 at RecursiveSpinLockWithInnerEventsTest.causesSpinLock(RecursiveSpinLockTest.kt:132)                                      |
|                                                                                                              |     /* The following events repeat infinitely: */                                                                                              |
|                                                                                                              | ┌╶> deadSpinCycleRecursive() at RecursiveSpinLockWithInnerEventsTest.causesSpinLock(RecursiveSpinLockTest.kt:133)                              |
|                                                                                                              | |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                  |
|                                                                                                              | |       someUselessSharedState.get(): false at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)            |
|                                                                                                              | |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                         |
|                                                                                                              | |       someUselessSharedState.compareAndSet(false, true): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145)   |
|                                                                                                              | |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                   |
|                                                                                                              | |       someUselessSharedState.get(): true at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)             |
|                                                                                                              | |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                          |
|                                                                                                              | |       someUselessSharedState.compareAndSet(true, false): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145)   |
|                                                                                                              | |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                  |
|                                                                                                              | |       someUselessSharedState.get(): false at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)            |
|                                                                                                              | |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                         |
|                                                                                                              | |       someUselessSharedState.compareAndSet(false, true): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145)   |
|                                                                                                              | |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                   |
|                                                                                                              | |       someUselessSharedState.get(): true at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)             |
|                                                                                                              | |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                          |
|                                                                                                              | |       someUselessSharedState.compareAndSet(true, false): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145)   |
|                                                                                                              | └╶╶╶╶ switch (reason: active lock detected)                                                                                                    |
|   counter.decrementAndGet(): 0 at RecursiveSpinLockWithInnerEventsTest.trigger(RecursiveSpinLockTest.kt:127) |                                                                                                                                                |
|   result: void                                                                                               |                                                                                                                                                |
|                                                                                                              |       /* The following events repeat infinitely: */                                                                                            |
|                                                                                                              |   ┌╶> deadSpinCycleRecursive() at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:142)                    |
|                                                                                                              |   |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                |
|                                                                                                              |   |       someUselessSharedState.get(): false at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)          |
|                                                                                                              |   |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                       |
|                                                                                                              |   |       someUselessSharedState.compareAndSet(false, true): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145) |
|                                                                                                              |   |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                 |
|                                                                                                              |   |       someUselessSharedState.get(): true at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)           |
|                                                                                                              |   |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                        |
|                                                                                                              |   |       someUselessSharedState.compareAndSet(true, false): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145) |
|                                                                                                              |   |     getSharedVariable(): false at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                |
|                                                                                                              |   |       someUselessSharedState.get(): false at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)          |
|                                                                                                              |   |     action(false): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                       |
|                                                                                                              |   |       someUselessSharedState.compareAndSet(false, true): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145) |
|                                                                                                              |   |     getSharedVariable(): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:139)                 |
|                                                                                                              |   |       someUselessSharedState.get(): true at RecursiveSpinLockWithInnerEventsTest.getSharedVariable(RecursiveSpinLockTest.kt:147)           |
|                                                                                                              |   |     action(true): true at RecursiveSpinLockWithInnerEventsTest.deadSpinCycleRecursive(RecursiveSpinLockTest.kt:140)                        |
|                                                                                                              |   |       someUselessSharedState.compareAndSet(true, false): true at RecursiveSpinLockWithInnerEventsTest.action(RecursiveSpinLockTest.kt:145) |
|                                                                                                              |   └╶╶╶╶ switch (reason: active lock detected)                                                                                                  |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
All unfinished threads are in deadlock
