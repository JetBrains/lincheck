= The execution has hung =
| ------------------ |
|      Thread 1      |
| ------------------ |
| livelock(): <hung> |
| ------------------ |


The following interleaving leads to the error:
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                   Thread 1                    |                                                                                              Thread 2                                                                                              |                                                                                              Thread 3                                                                                              |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| livelock(): <hung>                            |                                                                                                                                                                                                    |                                                                                                                                                                                                    |
|   switch                                      |                                                                                                                                                                                                    |                                                                                                                                                                                                    |
|                                               |                                                                                                                                                                                                    | run()                                                                                                                                                                                              |
|                                               |                                                                                                                                                                                                    |   CustomThreadsRepresentationTest$livelock$t2$1.invoke() at ThreadsKt$thread$thread$1.run(Thread.kt:30)                                                                                            |
|                                               |                                                                                                                                                                                                    |     invoke() at CustomThreadsRepresentationTest$livelock$t2$1.invoke(CustomThreadsRepresentationTest.kt:69)                                                                                        |
|                                               |                                                                                                                                                                                                    |       SpinLockTestKt.withLock(SpinLock#1,CustomThreadsRepresentationTest$livelock$t2$1$1) at CustomThreadsRepresentationTest$livelock$t2$1.invoke(CustomThreadsRepresentationTest.kt:70)           |
|                                               |                                                                                                                                                                                                    |         SpinLock#1.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                           |
|                                               |                                                                                                                                                                                                    |         switch                                                                                                                                                                                     |
|                                               | run()                                                                                                                                                                                              |                                                                                                                                                                                                    |
|                                               |   CustomThreadsRepresentationTest$livelock$t1$1.invoke() at ThreadsKt$thread$thread$1.run(Thread.kt:30)                                                                                            |                                                                                                                                                                                                    |
|                                               |     invoke() at CustomThreadsRepresentationTest$livelock$t1$1.invoke(CustomThreadsRepresentationTest.kt:62)                                                                                        |                                                                                                                                                                                                    |
|                                               |       SpinLockTestKt.withLock(SpinLock#2,CustomThreadsRepresentationTest$livelock$t1$1$1) at CustomThreadsRepresentationTest$livelock$t1$1.invoke(CustomThreadsRepresentationTest.kt:63)           |                                                                                                                                                                                                    |
|                                               |         SpinLock#2.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                           |                                                                                                                                                                                                    |
|                                               |         CustomThreadsRepresentationTest$livelock$t1$1$1.invoke() at SpinLockTestKt.withLock(SpinLockTest.kt:97)                                                                                    |                                                                                                                                                                                                    |
|                                               |           invoke() at CustomThreadsRepresentationTest$livelock$t1$1$1.invoke(CustomThreadsRepresentationTest.kt:63)                                                                                |                                                                                                                                                                                                    |
|                                               |             SpinLockTestKt.withLock(SpinLock#1,CustomThreadsRepresentationTest$livelock$t1$1$1$1) at CustomThreadsRepresentationTest$livelock$t1$1$1.invoke(CustomThreadsRepresentationTest.kt:64) |                                                                                                                                                                                                    |
|                                               |               SpinLock#1.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                     |                                                                                                                                                                                                    |
|                                               |                 /* The following events repeat infinitely: */                                                                                                                                      |                                                                                                                                                                                                    |
|                                               |             ┌╶> AtomicBoolean#1.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |                                                                                                                                                                                                    |
|                                               |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |                                                                                                                                                                                                    |
|                                               |                                                                                                                                                                                                    |         CustomThreadsRepresentationTest$livelock$t2$1$1.invoke() at SpinLockTestKt.withLock(SpinLockTest.kt:97)                                                                                    |
|                                               |                                                                                                                                                                                                    |           invoke() at CustomThreadsRepresentationTest$livelock$t2$1$1.invoke(CustomThreadsRepresentationTest.kt:70)                                                                                |
|                                               |                                                                                                                                                                                                    |             SpinLockTestKt.withLock(SpinLock#2,CustomThreadsRepresentationTest$livelock$t2$1$1$1) at CustomThreadsRepresentationTest$livelock$t2$1$1.invoke(CustomThreadsRepresentationTest.kt:71) |
|                                               |                                                                                                                                                                                                    |               SpinLock#2.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                     |
|                                               |                                                                                                                                                                                                    |                 /* The following events repeat infinitely: */                                                                                                                                      |
|                                               |                                                                                                                                                                                                    |             ┌╶> AtomicBoolean#2.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |
|                                               |                                                                                                                                                                                                    |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |
|   switch (reason: waiting for thread to join) |                                                                                                                                                                                                    |                                                                                                                                                                                                    |
|                                               |                                                                                                                                                                                                    |                 /* The following events repeat infinitely: */                                                                                                                                      |
|                                               |                                                                                                                                                                                                    |             ┌╶> AtomicBoolean#2.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |
|                                               |                                                                                                                                                                                                    |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |
|                                               |                 /* The following events repeat infinitely: */                                                                                                                                      |                                                                                                                                                                                                    |
|                                               |             ┌╶> AtomicBoolean#1.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |                                                                                                                                                                                                    |
|                                               |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |                                                                                                                                                                                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
All unfinished threads are in deadlock

Detailed trace:
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                   Thread 1                    |                                                                                              Thread 2                                                                                              |                                                                                              Thread 3                                                                                              |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| livelock(): <hung>                            |                                                                                                                                                                                                    |                                                                                                                                                                                                    |
|   switch                                      |                                                                                                                                                                                                    |                                                                                                                                                                                                    |
|                                               |                                                                                                                                                                                                    | run()                                                                                                                                                                                              |
|                                               |                                                                                                                                                                                                    |   CustomThreadsRepresentationTest$livelock$t2$1.invoke() at ThreadsKt$thread$thread$1.run(Thread.kt:30)                                                                                            |
|                                               |                                                                                                                                                                                                    |     invoke() at CustomThreadsRepresentationTest$livelock$t2$1.invoke(CustomThreadsRepresentationTest.kt:69)                                                                                        |
|                                               |                                                                                                                                                                                                    |       SpinLockTestKt.withLock(SpinLock#1,CustomThreadsRepresentationTest$livelock$t2$1$1) at CustomThreadsRepresentationTest$livelock$t2$1.invoke(CustomThreadsRepresentationTest.kt:70)           |
|                                               |                                                                                                                                                                                                    |         SpinLock#1.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                           |
|                                               |                                                                                                                                                                                                    |           AtomicBoolean#1.compareAndSet(false,true): true at SpinLock.lock(SpinLockTest.kt:84)                                                                                                     |
|                                               |                                                                                                                                                                                                    |         switch                                                                                                                                                                                     |
|                                               | run()                                                                                                                                                                                              |                                                                                                                                                                                                    |
|                                               |   CustomThreadsRepresentationTest$livelock$t1$1.invoke() at ThreadsKt$thread$thread$1.run(Thread.kt:30)                                                                                            |                                                                                                                                                                                                    |
|                                               |     invoke() at CustomThreadsRepresentationTest$livelock$t1$1.invoke(CustomThreadsRepresentationTest.kt:62)                                                                                        |                                                                                                                                                                                                    |
|                                               |       SpinLockTestKt.withLock(SpinLock#2,CustomThreadsRepresentationTest$livelock$t1$1$1) at CustomThreadsRepresentationTest$livelock$t1$1.invoke(CustomThreadsRepresentationTest.kt:63)           |                                                                                                                                                                                                    |
|                                               |         SpinLock#2.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                           |                                                                                                                                                                                                    |
|                                               |           AtomicBoolean#2.compareAndSet(false,true): true at SpinLock.lock(SpinLockTest.kt:84)                                                                                                     |                                                                                                                                                                                                    |
|                                               |         CustomThreadsRepresentationTest$livelock$t1$1$1.invoke() at SpinLockTestKt.withLock(SpinLockTest.kt:97)                                                                                    |                                                                                                                                                                                                    |
|                                               |           invoke() at CustomThreadsRepresentationTest$livelock$t1$1$1.invoke(CustomThreadsRepresentationTest.kt:63)                                                                                |                                                                                                                                                                                                    |
|                                               |             SpinLockTestKt.withLock(SpinLock#1,CustomThreadsRepresentationTest$livelock$t1$1$1$1) at CustomThreadsRepresentationTest$livelock$t1$1$1.invoke(CustomThreadsRepresentationTest.kt:64) |                                                                                                                                                                                                    |
|                                               |               SpinLock#1.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                     |                                                                                                                                                                                                    |
|                                               |                 /* The following events repeat infinitely: */                                                                                                                                      |                                                                                                                                                                                                    |
|                                               |             ┌╶> AtomicBoolean#1.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |                                                                                                                                                                                                    |
|                                               |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |                                                                                                                                                                                                    |
|                                               |                                                                                                                                                                                                    |         CustomThreadsRepresentationTest$livelock$t2$1$1.invoke() at SpinLockTestKt.withLock(SpinLockTest.kt:97)                                                                                    |
|                                               |                                                                                                                                                                                                    |           invoke() at CustomThreadsRepresentationTest$livelock$t2$1$1.invoke(CustomThreadsRepresentationTest.kt:70)                                                                                |
|                                               |                                                                                                                                                                                                    |             SpinLockTestKt.withLock(SpinLock#2,CustomThreadsRepresentationTest$livelock$t2$1$1$1) at CustomThreadsRepresentationTest$livelock$t2$1$1.invoke(CustomThreadsRepresentationTest.kt:71) |
|                                               |                                                                                                                                                                                                    |               SpinLock#2.lock() at SpinLockTestKt.withLock(SpinLockTest.kt:95)                                                                                                                     |
|                                               |                                                                                                                                                                                                    |                 /* The following events repeat infinitely: */                                                                                                                                      |
|                                               |                                                                                                                                                                                                    |             ┌╶> AtomicBoolean#2.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |
|                                               |                                                                                                                                                                                                    |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |
|   switch (reason: waiting for thread to join) |                                                                                                                                                                                                    |                                                                                                                                                                                                    |
|                                               |                                                                                                                                                                                                    |                 /* The following events repeat infinitely: */                                                                                                                                      |
|                                               |                                                                                                                                                                                                    |             ┌╶> AtomicBoolean#2.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |
|                                               |                                                                                                                                                                                                    |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |
|                                               |                 /* The following events repeat infinitely: */                                                                                                                                      |                                                                                                                                                                                                    |
|                                               |             ┌╶> AtomicBoolean#1.compareAndSet(false,true): false at SpinLock.lock(SpinLockTest.kt:84)                                                                                              |                                                                                                                                                                                                    |
|                                               |             └╶╶ switch (reason: active lock detected)                                                                                                                                              |                                                                                                                                                                                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
All unfinished threads are in deadlock
